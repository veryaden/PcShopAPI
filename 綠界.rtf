{\rtf1\adeflang1025\ansi\ansicpg950\uc2\adeff0\deff0\stshfdbch31505\stshfloch31506\stshfhich31506\stshfbi0\deflang1033\deflangfe1028\themelang1033\themelangfe1028\themelangcs0{\fonttbl{\f0\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}
{\f14\fbidi \froman\fcharset136\fprq2{\*\panose 02020500000000000000}\'b7\'73\'b2\'d3\'a9\'fa\'c5\'e9{\*\falt PMingLiU};}{\f18\fbidi \fmodern\fcharset136\fprq1{\*\panose 02020509000000000000}\'b2\'d3\'a9\'fa\'c5\'e9{\*\falt MingLiU};}
{\f34\fbidi \froman\fcharset0\fprq2{\*\panose 02040503050406030204}Cambria Math;}{\f37\fbidi \fswiss\fcharset0\fprq2{\*\panose 020f0502020204030204}Calibri;}{\f43\fbidi \fmodern\fcharset136\fprq1{\*\panose 00000000000000000000}@\'b2\'d3\'a9\'fa\'c5\'e9;}
{\f44\fbidi \froman\fcharset136\fprq2{\*\panose 00000000000000000000}@\'b7\'73\'b2\'d3\'a9\'fa\'c5\'e9;}{\flomajor\f31500\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}
{\fdbmajor\f31501\fbidi \froman\fcharset136\fprq2{\*\panose 02020500000000000000}\'b7\'73\'b2\'d3\'a9\'fa\'c5\'e9{\*\falt PMingLiU};}{\fhimajor\f31502\fbidi \fswiss\fcharset0\fprq2{\*\panose 020f0302020204030204}Calibri Light;}
{\fbimajor\f31503\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\flominor\f31504\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}
{\fdbminor\f31505\fbidi \froman\fcharset136\fprq2{\*\panose 02020500000000000000}\'b7\'73\'b2\'d3\'a9\'fa\'c5\'e9{\*\falt PMingLiU};}{\fhiminor\f31506\fbidi \fswiss\fcharset0\fprq2{\*\panose 020f0502020204030204}Calibri;}
{\fbiminor\f31507\fbidi \froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\f45\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}{\f46\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}
{\f48\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}{\f49\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}{\f50\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}{\f51\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}
{\f52\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}{\f53\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}{\f187\fbidi \froman\fcharset0\fprq2 PMingLiU Western{\*\falt PMingLiU};}
{\f227\fbidi \fmodern\fcharset0\fprq1 MingLiU Western{\*\falt MingLiU};}{\f385\fbidi \froman\fcharset238\fprq2 Cambria Math CE;}{\f386\fbidi \froman\fcharset204\fprq2 Cambria Math Cyr;}{\f388\fbidi \froman\fcharset161\fprq2 Cambria Math Greek;}
{\f389\fbidi \froman\fcharset162\fprq2 Cambria Math Tur;}{\f392\fbidi \froman\fcharset186\fprq2 Cambria Math Baltic;}{\f393\fbidi \froman\fcharset163\fprq2 Cambria Math (Vietnamese);}{\f415\fbidi \fswiss\fcharset238\fprq2 Calibri CE;}
{\f416\fbidi \fswiss\fcharset204\fprq2 Calibri Cyr;}{\f418\fbidi \fswiss\fcharset161\fprq2 Calibri Greek;}{\f419\fbidi \fswiss\fcharset162\fprq2 Calibri Tur;}{\f420\fbidi \fswiss\fcharset177\fprq2 Calibri (Hebrew);}
{\f421\fbidi \fswiss\fcharset178\fprq2 Calibri (Arabic);}{\f422\fbidi \fswiss\fcharset186\fprq2 Calibri Baltic;}{\f423\fbidi \fswiss\fcharset163\fprq2 Calibri (Vietnamese);}{\f477\fbidi \fmodern\fcharset0\fprq1 @MingLiU Western;}
{\f487\fbidi \froman\fcharset0\fprq2 @PMingLiU Western;}{\flomajor\f31508\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}{\flomajor\f31509\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}
{\flomajor\f31511\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}{\flomajor\f31512\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}{\flomajor\f31513\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}
{\flomajor\f31514\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}{\flomajor\f31515\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}{\flomajor\f31516\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}
{\fdbmajor\f31520\fbidi \froman\fcharset0\fprq2 PMingLiU Western{\*\falt PMingLiU};}{\fhimajor\f31528\fbidi \fswiss\fcharset238\fprq2 Calibri Light CE;}{\fhimajor\f31529\fbidi \fswiss\fcharset204\fprq2 Calibri Light Cyr;}
{\fhimajor\f31531\fbidi \fswiss\fcharset161\fprq2 Calibri Light Greek;}{\fhimajor\f31532\fbidi \fswiss\fcharset162\fprq2 Calibri Light Tur;}{\fhimajor\f31533\fbidi \fswiss\fcharset177\fprq2 Calibri Light (Hebrew);}
{\fhimajor\f31534\fbidi \fswiss\fcharset178\fprq2 Calibri Light (Arabic);}{\fhimajor\f31535\fbidi \fswiss\fcharset186\fprq2 Calibri Light Baltic;}{\fhimajor\f31536\fbidi \fswiss\fcharset163\fprq2 Calibri Light (Vietnamese);}
{\fbimajor\f31538\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}{\fbimajor\f31539\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}{\fbimajor\f31541\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}
{\fbimajor\f31542\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}{\fbimajor\f31543\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}{\fbimajor\f31544\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}
{\fbimajor\f31545\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}{\fbimajor\f31546\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}{\flominor\f31548\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}
{\flominor\f31549\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}{\flominor\f31551\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}{\flominor\f31552\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}
{\flominor\f31553\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}{\flominor\f31554\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}{\flominor\f31555\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}
{\flominor\f31556\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}{\fdbminor\f31560\fbidi \froman\fcharset0\fprq2 PMingLiU Western{\*\falt PMingLiU};}{\fhiminor\f31568\fbidi \fswiss\fcharset238\fprq2 Calibri CE;}
{\fhiminor\f31569\fbidi \fswiss\fcharset204\fprq2 Calibri Cyr;}{\fhiminor\f31571\fbidi \fswiss\fcharset161\fprq2 Calibri Greek;}{\fhiminor\f31572\fbidi \fswiss\fcharset162\fprq2 Calibri Tur;}
{\fhiminor\f31573\fbidi \fswiss\fcharset177\fprq2 Calibri (Hebrew);}{\fhiminor\f31574\fbidi \fswiss\fcharset178\fprq2 Calibri (Arabic);}{\fhiminor\f31575\fbidi \fswiss\fcharset186\fprq2 Calibri Baltic;}
{\fhiminor\f31576\fbidi \fswiss\fcharset163\fprq2 Calibri (Vietnamese);}{\fbiminor\f31578\fbidi \froman\fcharset238\fprq2 Times New Roman CE;}{\fbiminor\f31579\fbidi \froman\fcharset204\fprq2 Times New Roman Cyr;}
{\fbiminor\f31581\fbidi \froman\fcharset161\fprq2 Times New Roman Greek;}{\fbiminor\f31582\fbidi \froman\fcharset162\fprq2 Times New Roman Tur;}{\fbiminor\f31583\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew);}
{\fbiminor\f31584\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic);}{\fbiminor\f31585\fbidi \froman\fcharset186\fprq2 Times New Roman Baltic;}{\fbiminor\f31586\fbidi \froman\fcharset163\fprq2 Times New Roman (Vietnamese);}}
{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;
\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;\red0\green0\blue0;\red0\green0\blue0;\red43\green145\blue175;\red163\green21\blue21;}{\*\defchp 
\fs24\kerning2\loch\af31506\hich\af31506\dbch\af31505 }{\*\defpap \ql \li0\ri0\widctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 }\noqfpromote {\stylesheet{
\ql \li0\ri0\nowidctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \rtlch\fcs1 \af0\afs22\alang1025 \ltrch\fcs0 \fs24\lang1033\langfe1028\kerning2\loch\f31506\hich\af31506\dbch\af31505\cgrid\langnp1033\langfenp1028 
\snext0 \sqformat \spriority0 Normal;}{\*\cs10 \additive \ssemihidden \sunhideused \spriority1 Default Paragraph Font;}{\*
\ts11\tsrowd\trftsWidthB3\trpaddl108\trpaddr108\trpaddfl3\trpaddft3\trpaddfb3\trpaddfr3\trcbpat1\trcfpat1\tblind0\tblindtype3\tsvertalt\tsbrdrt\tsbrdrl\tsbrdrb\tsbrdrr\tsbrdrdgl\tsbrdrdgr\tsbrdrh\tsbrdrv 
\ql \li0\ri0\widctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \rtlch\fcs1 \af0\afs24\alang1025 \ltrch\fcs0 \fs24\lang1033\langfe1028\kerning2\loch\f31506\hich\af31506\dbch\af31505\cgrid\langnp1033\langfenp1028 
\snext11 \ssemihidden \sunhideused Normal Table;}}{\*\rsidtbl \rsid1995776\rsid9010905\rsid9206233}{\mmathPr\mmathFont34\mbrkBin0\mbrkBinSub0\msmallFrac0\mdispDef1\mlMargin0\mrMargin0\mdefJc1\mwrapIndent1440\mintLim0\mnaryLim1}{\info{\operator User}
{\creatim\yr2026\mo1\dy7\hr11\min42}{\revtim\yr2026\mo1\dy7\hr18\min24}{\version3}{\edmins4}{\nofpages15}{\nofwords3588}{\nofchars20454}{\nofcharsws23995}{\vern81}}{\*\xmlnstbl {\xmlns1 http://schemas.microsoft.com/office/word/2003/wordml}}
\paperw12240\paperh15840\margl1800\margr1800\margt1440\margb1440\gutter0\ltrsect 
\ftnbj\aenddoc\trackmoves0\trackformatting1\donotembedsysfont0\relyonvml0\donotembedlingdata1\grfdocevents0\validatexml0\showplaceholdtext0\ignoremixedcontent0\saveinvalidxml0\showxmlerrors0\horzdoc\dghspace120\dgvspace120\dghorigin1701\dgvorigin1984
\dghshow0\dgvshow3\jcompress\viewkind1\viewscale120\rsidroot9206233 \fet0{\*\wgrffmtfilter 2450}\ilfomacatclnup0\ltrpar \sectd \ltrsect\linex0\sectdefaultcl\sftnbj {\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang {\pntxta \dbch .}}{\*\pnseclvl2
\pnucltr\pnstart1\pnindent720\pnhang {\pntxta \dbch .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang {\pntxta \dbch .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang {\pntxta \dbch )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang {\pntxtb \dbch (}
{\pntxta \dbch )}}{\*\pnseclvl6\pnlcltr\pnstart1\pnindent720\pnhang {\pntxtb \dbch (}{\pntxta \dbch )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang {\pntxtb \dbch (}{\pntxta \dbch )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang {\pntxtb \dbch (}
{\pntxta \dbch )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang {\pntxtb \dbch (}{\pntxta \dbch )}}\pard\plain \ltrpar\ql \li0\ri0\nowidctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \rtlch\fcs1 \af0\afs22\alang1025 \ltrch\fcs0 
\fs24\lang1033\langfe1028\kerning2\loch\af31506\hich\af31506\dbch\af31505\cgrid\langnp1033\langfenp1028 {\rtlch\fcs1 \af0\afs28 \ltrch\fcs0 \fs28\insrsid9206233\charrsid9206233 \hich\af31506\dbch\af31505\loch\f31506 Ecpay.service}{\rtlch\fcs1 \af0\afs28 
\ltrch\fcs0 \fs28\insrsid9010905\charrsid9206233 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid9206233 
\par }\pard \ltrpar\ql \li0\ri0\nowidctlpar\wrapdefault\faauto\rin0\lin0\itap0\pararsid9206233 {\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 using}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  FrameZone_WebApi.Controllers;
\par }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 using}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18  FrameZone_WebApi.Shopping.DTOs;
\par }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 using}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18  Microsoft.Extensions.Logging;
\par }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 using}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18  System.Security.Cryptography;
\par }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 using}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18  System.Text;
\par }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 using}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18  System.Web;
\par 
\par }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 namespace}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18  FrameZone_WebApi.Shopping.Services
\par \{
\par \hich\af31506\dbch\af18\loch\f18     }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 public}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 class}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 ECPayService}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18     \{
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 private}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 readonly}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 IConfiguration}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  _configuration;
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 private}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 readonly}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 ILogger}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 <}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ECPayService}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 
> _logger;
\par 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 // }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'b3\'5d\'a9\'77\'a6\'55\'b0\'d1\'bc\'c6\'aa\'ba\'b3\'cc\'a4\'6a\'aa\'f8\'ab\'d7\'a1\'5d\'a5\'75\'a6\'43\'af\'53\'a7\'4f\'bb\'dd\'ad\'6e\'c0\'cb\'ac\'64
\'aa\'ba\'a1\'5e}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 private}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 Dictionary}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 <}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 int}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 
> ECPayOrderParamsMaxLength = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 new}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 Dictionary}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 <}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 int}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 > \{
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //\{"MerchantID", 10\},}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "MerchantTradeNo"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , 20\},
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //\{"MerchantTradeDate", 20\},}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //\{"PaymentType", 20\},}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "\hich\af31506\dbch\af18\loch\f18 TradeDesc"}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , 200\},
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "ItemName"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , 400\},
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //\{"ReturnURL", 200\},}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //\{"ChoosePayment", 20\},}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //\{"ClientBackURL", 200\},}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //\{"OrderResultURL", 200\},}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18         \};
\par 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 public}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ECPayService}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 (}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 IConfiguration}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  configuration, }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ILogger}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 <}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ECPayService}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 > logger)
\par \hich\af31506\dbch\af18\loch\f18         \{
\par \hich\af31506\dbch\af18\loch\f18             _configuration = configuration;
\par \hich\af31506\dbch\af18\loch\f18             _logger = logger;
\par \hich\af31506\dbch\af18\loch\f18         \}
\par 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 // }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'b7\'c7\'b3\'c6\'ba\'f1\'ac\'c9\'ad\'6e\'aa\'ba\'b0\'d1\'bc\'c6}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 // }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'b1\'4e}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 
 merchantTradeNo }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'a7\'ef\'ac\'b0\'a5\'7e\'b3\'a1\'b6\'c7\'a4\'4a\'a1\'41\'ac\'4f\'ac\'b0\'a4\'46\'c5\'fd}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  Controller }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\loch\af18\hich\af31506\dbch\f18 \'af\'e0\'b0\'f7\'ba\'eb\'bd\'54\'b1\'b1\'a8\'ee\'a5\'e6\'a9\'f6\'bd\'73\'b8\'b9\'a1\'5d\'a8\'d2\'a6\'70\'a5\'5d\'a7\'74}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  OrderId}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'a1\'5e
\'a1\'41}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 // }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'b3\'6f\'bc\'cb\'a6\'62\'ba\'f1\'ac\'c9\'ab\'44\loch\af18\hich\af31506\dbch\f18 \'a6\'50\'a8\'42\'a6\'5e\'b6\'c7\'a5\'49\'b4\'da\'b5\'b2\'aa\'47\'ae\'c9
\'a1\'41\'a4\'7e\'af\'e0\'b7\'c7\'bd\'54\'a6\'61\'a7\'ec\'a8\'ec\'ac\'4f\'b9\'ef\'c0\'b3\'ad\'fe\'a4\'40\'b5\'a7\'a5\'bb\'a6\'61\'ad\'71\'b3\'e6\'a1\'43}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 

\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 public}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ECPayOrderParamsDto
}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  CreateECPayOrder(}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 OrderDto}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  order, }{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18  merchantTradeNo)
\par \hich\af31506\dbch\af18\loch\f18         \{
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ECPayOrderParamsDto}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  orderParams = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 new}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 ECPayOrderParamsDto}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ();
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 // string serialNum = DateTime.Now.Ticks\hich\af31506\dbch\af18\loch\f18 
.ToString().Substring(0, 10);}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par 
\par \hich\af31506\dbch\af18\loch\f18             orderParams.Params[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "MerchantID"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ] = _configuration[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 
"ECPaySettings:MerchantID"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ];
\par \hich\af31506\dbch\af18\loch\f18             orderParams.Params[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "MerchantTradeNo"}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ] = merchantTradeNo;
\par \hich\af31506\dbch\af18\loch\f18             orderParams.Params[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "MerchantTradeDate"}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ] = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 
DateTime}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 .No\hich\af31506\dbch\af18\loch\f18 w.ToString(}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "yyyy/MM/dd HH:mm:ss"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 );
\par \hich\af31506\dbch\af18\loch\f18             orderParams.Params[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "TotalAmount"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ] = order.TotalAmount;
\par \hich\af31506\dbch\af18\loch\f18             orderParams.Params[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "TradeDesc"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ] = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 
"FrameZone Order "}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  + merchantTradeNo;
\par \hich\af31506\dbch\af18\loch\f18             orderParams.Params[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "ChoosePayment"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ] = order.PaymentMethod;
\par \hich\af31506\dbch\af18\loch\f18             orderParams.Params[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "ReturnURL"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ] = order.ReturnURL;
\par 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'bc\'67\'a6\'62\'ba\'f1\'ac\'c9\'a5\'49\'b4\'da\'b5\'65\'ad\'b1\'aa\'ba\'b0\'d3\'ab\'7e\'a9\'fa\'b2\'d3}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 if}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  (order.OrderItems != }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 null}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 )
\par \hich\af31506\dbch\af18\loch\f18             \{
\par \hich\af31506\dbch\af18\loch\f18                 }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 StringBuilder}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  stringBuilder = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 new}
{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 StringBuilder}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ();
\par \hich\af31506\dbch\af18\loch\f18                 }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 bool}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  isFirst = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 true}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ;
\par 
\par \hich\af31506\dbch\af18\loch\f18                 }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 foreach}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  (}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 var}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  item }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 in}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  order.OrderItems)
\par \hich\af31506\dbch\af18\loch\f18                 \{
\par \hich\af31506\dbch\af18\loch\f18                     }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 if}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  (isFirst)
\par \hich\af31506\dbch\af18\loch\f18                     \{
\par \hich\af31506\dbch\af18\loch\f18                         stringBuilder.Append(item.Name?.ToString() + }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 " * "}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  + item.Quantity.ToString());
\par \hich\af31506\dbch\af18\loch\f18                         \hich\af31506\dbch\af18\loch\f18 isFirst = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 false}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ;
\par \hich\af31506\dbch\af18\loch\f18                     \}
\par \hich\af31506\dbch\af18\loch\f18                     }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 else}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18                     \{
\par \hich\af31506\dbch\af18\loch\f18                         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'b2\'c4\'a4\'47\'bc\'cb\'a5\'48\'a4\'57\'b0\'d3\'ab\'7e\'a5\'ce}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 #}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'b4\'ab\'a6\'e6}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18                         stringBuilder.Append(}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "#"}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  + item.Name?.ToString() + }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 " * "}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  + item.Quantity.ToString());
\par \hich\af31506\dbch\af18\loch\f18                     \}
\par \hich\af31506\dbch\af18\loch\f18                 \}
\par 
\par \hich\af31506\dbch\af18\loch\f18                 orderParams.Params[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "ItemName"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ] = stringBuilder.ToString();
\par \hich\af31506\dbch\af18\loch\f18             \}
\par 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'a8\'e4\'a5\'4c\'a5\'69\'bf\'ef\'b0\'d1\'bc\'c6\'b1\'61\'a4\'4a\'ab\'65\'ba\'dd\'b5\'b9\'aa\'ba\'b8\'ea\'b0\'54}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 if}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  (order.OptionParams != }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 null}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 )
\par \hich\af31506\dbch\af18\loch\f18             \{
\par \hich\af31506\dbch\af18\loch\f18                 }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 foreach}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  (}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 KeyValuePair}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 <}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 object}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 > option }{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 in}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18  order.OptionParams)
\par \hich\af31506\dbch\af18\loch\f18                 \{
\par \hich\af31506\dbch\af18\loch\f18                     orderParams.Params.Add(option.Key, option.Value);
\par \hich\af31506\dbch\af18\loch\f18                 \}
\par \hich\af31506\dbch\af18\loch\f18             \}
\par 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 return}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  CheckECPayOrderParams(orderParams);
\par \hich\af31506\dbch\af18\loch\f18         \}
\par 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 public}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 void}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  HandleECPayOrderResult(}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 FormCollection}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  result)
\par \hich\af31506\dbch\af18\loch\f18         \{
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //_logger.LogInformation(result.ToString()); //}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'a5\'49\'b4\'da\'a7\'b9\'a6\'a8\'b5\'b2\'aa\'47\'ac\'f6\'bf\'fd\'a6\'62}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 log}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'a1\'41\'c1\'d9
\'a5\'bc\'bc\'67\'b6\'69\'b8\'ea\'ae\'c6\'ae\'77}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18         \}
\par 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 private}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ECPayOrderParamsDto
}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  CheckECPayOrderParams(}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ECPayOrderParamsDto}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 
 orderParams)
\par \hich\af31506\dbch\af18\loch\f18         \{
\par \hich\af31506\dbch\af18\loch\f18        \hich\af31506\dbch\af18\loch\f18      }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 // }{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'c0\'cb\'ac\'64\'a6\'55\'b6\'b5\'b0\'d1\'bc\'c6\'ac\'4f\'a7\'5f\'b6\'57\'b9\'4c\'b3\'cc\'a4\'6a\'aa\'f8\'ab\'d7}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 foreach}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  (}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 KeyValuePair}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 <}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 int}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 > kvp }{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 in}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18  ECPayOrderParamsMaxLength)
\par \hich\af31506\dbch\af18\loch\f18             \{
\par \hich\af31506\dbch\af18\loch\f18                 }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 object}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ? checkObject;
\par \hich\af31506\dbch\af18\loch\f18                 }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 if}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  (orderParams.Params.TryGetValue(kvp.Key, }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 out}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  checkObject)) }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'c0\'cb\'ac\'64
\'ac\'4f\'a7\'5f\'a6\'b3\'b0\'d1\'bc\'c6\'a6\'57\'ba\'d9}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18            \hich\af31506\dbch\af18\loch\f18      \{
\par \hich\af31506\dbch\af18\loch\f18                     }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  checkString = (}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 
string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 )checkObject;
\par \hich\af31506\dbch\af18\loch\f18                     }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 if}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  (checkString.Length >= kvp.Value) }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 //}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'c0\'cb\'ac\'64\'b0\'d1\'bc\'c6\'aa\'f8\'ab\'d7\'ac\'4f\'a7\'5f\'b6\'57\'b9\'4c
\'b3\'5d\'a9\'77\'ad\'c8}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18                     \{
\par \hich\af31506\dbch\af18\loch\f18                         orderParams.Params[kvp.Key] = checkString.Substring(0, kvp.Value); }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 //}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'a6\'70\'aa\'47\'aa\'f8\'ab\'d7\'b6\'57\'b9\'4c\'a5\'75\'a8\'fa\'a8\'ec\'b3\'cc
\'a4\'6a\'aa\'f8\'ab\'d7}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18                     \}
\par \hich\af31506\dbch\af18\loch\f18                 \}
\par \hich\af31506\dbch\af18\loch\f18             \}
\par 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 // }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'ad\'70\'ba\'e2\'c0\'cb\'ac\'64\'bd\'58}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  orderParamsString = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 
string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 .Join(}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 "&"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , orderParams.Params.Keys.OrderBy(key => key).Select(key => key + }{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "="}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18  + orderParams.Params[key].ToString()).To\hich\af31506\dbch\af18\loch\f18 List());
\par \hich\af31506\dbch\af18\loch\f18             orderParams.Params[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "CheckMacValue"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ] = BuildCheckMacValue(orderParamsString);
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'ba\'f1\'ac\'c9\'bd\'64\'a8\'d2}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 :orderParams.Params["CheckMacValue"] = BuildCheckMacValue("ChoosePayment=ALL&EncryptType=1&ItemName=Apple iphone 15&MerchantID=3002607&Merch\hich\af31506\dbch\af18\loch\f18 
antTradeDate=2023/03/12 15:30:23&MerchantTradeNo=ecpay20230312153023&PaymentType=aio&ReturnURL=https://www.ecpay.com.tw/receive.php&TotalAmount=30000&TradeDesc=}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'ab\'50\'be\'50\'a4\'e8\'ae\'d7}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 ");}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //Debug }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'c0\'cb\'ac\'64\'a5\'ce}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //string debug = string.Format("HashKey=\{0\}&\{1\}
\hich\af31506\dbch\af18\loch\f18 &HashIV=\{2\}", _configuration["ECPaySettings:HashKey"], orderParamsString, _configuration["ECPaySettings:HashIV"]);}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 

\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //orderParams.OrderParamsString = debug;}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par 
\par 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 return}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  orderParams;
\par \hich\af31506\dbch\af18\loch\f18         \}
\par 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'b0\'d1\'a6\'d2\'ba\'f1\'ac\'c9\'a4\'e5\'a5\'f3\'bb\'a1\'a9\'fa\'ad\'70\'ba\'e2\'c0\'cb\'ac\'64\'bd\'58}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //https://d\hich\af31506\dbch\af18\loch\f18 evelopers.ecpay.com.tw/?p=2902}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 private}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  BuildCheckMacValue(}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  orderParamsString)
\par \hich\af31506\dbch\af18\loch\f18         \{
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  result = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ""}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ;
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 SHA256}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  encoder = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 SHA256}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 .Create();
\par 
\par \hich\af31506\dbch\af18\loch\f18             result = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 .Format(}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "HashKey=\{0
\}&\{1\}&HashIV=\{2\}"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , _configuration[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "ECPaySettings:HashKey"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 ], orderParamsString, _configuration[}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "ECPaySettings:HashIV"}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ]);
\par \hich\af31506\dbch\af18\loch\f18             result = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 HttpUtility}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 .UrlEncode(result).ToLower();
\par 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 byte}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 [] data = encoder.ComputeHash(}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 Encoding}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 .UTF8.GetBytes(result));
\par \hich\af31506\dbch\af18\loch\f18            \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 StringBuilder}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  stringBuilder = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 new}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 StringBuilder}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ();

\par 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 for}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  (}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 int}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  i = 0; i < data.Length; i++)
\par \hich\af31506\dbch\af18\loch\f18             \{
\par \hich\af31506\dbch\af18\loch\f18                 stringBuilder.Append(data[i].ToString(}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "X2"}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ));
\par \hich\af31506\dbch\af18\loch\f18             \}
\par 
\par \hich\af31506\dbch\af18\loch\f18             result = stringBuilder.ToString();
\par 
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 return}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  result;
\par \hich\af31506\dbch\af18\loch\f18         \}
\par \hich\af31506\dbch\af18\loch\f18     \}
\par \}
\par }\pard \ltrpar\ql \li0\ri0\nowidctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid9206233 
\par }{\rtlch\fcs1 \af37\afs28 \ltrch\fcs0 \fs28\kerning0\highlight8\dbch\af31501\insrsid9206233\charrsid9206233 \hich\af31506\dbch\af31501\loch\f31506 ECPay Dto}{\rtlch\fcs1 \af37\afs28 \ltrch\fcs0 \fs28\dbch\af31501\insrsid9206233\charrsid9206233 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid9206233 
\par }\pard \ltrpar\ql \li0\ri0\nowidctlpar\wrapdefault\faauto\rin0\lin0\itap0\pararsid9206233 {\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 namespace}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  FrameZone_WebApi.Shopping.DTOs
\par \{
\par \hich\af31506\dbch\af18\loch\f18     }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'b5\'b9\'ab\'65\'ba\'dd\'aa\'ba\'c1\'f4\'c2\'c3\'aa\'ed\'b3\'e6}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18     }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 public}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 class}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 ECPayOrderParamsDto}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18     \{
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 // }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'a8\'cf\'a5\'ce\'ba\'f1\'ac\'c9}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18  API }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'bb\'dd\'ad\'6e\'aa\'ba}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  Header }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'ac\'db
\'c3\'f6\'b8\'ea\'b0\'54}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 (<form></form>)}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 public}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  HttpMethod \{ }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 get}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ; }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 set}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ; \} = }{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "POST"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 ;
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 public}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  ContentType \{ }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 get}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ; }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 set}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ; \} = }{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "application/x-www-form-urlencoded"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ;
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 public}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  ServiceURL \{ }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 get}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ; }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 set}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ; \} = }{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "https://payment-stage.ecpay.com.tw/Cashier/AioCheckOut/V5"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ;
\par 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 // }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'b0\'f2\'a5\'bb\'b0\'d1\'bc\'c6\'bc\'d2\'aa\'4f}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 (<input />)}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 public}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 Dictionary}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 <}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 object}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 > Params \{ }{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 get}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 ; }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 set}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ; \} = }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 new}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf19\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 Dictionary}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 <}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 string}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf2\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 object}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\hich\af31506\dbch\af18\loch\f18 > \{
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "MerchantID"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ""}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \},
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "MerchantTradeNo"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ""}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \},
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "MerchantTradeDate"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ""}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \},
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "PaymentType"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "aio"}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \},
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "TotalAmount"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , 0\},
\par \hich\af31506\dbch\af18\loch\f18         \hich\af31506\dbch\af18\loch\f18     \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "TradeDesc"}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ""}{
\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \},
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "ItemName"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ""}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \},
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "ReturnURL"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ""}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \},
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "ChoosePayment"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 ""}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \},
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //\{"CheckMacValue", ""\}, }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'ad\'70\'ba\'e2\'c0\'cb\'ac\'64\'bd\'58\'ab\'e1\'a6\'41\'b7\'73\'bc\'57}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18             \{}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf20\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 "EncryptType"}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 , 1\},
\par \hich\af31506\dbch\af18\loch\f18             }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 // }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'a8\'e4\'a5\'4c}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 
 optional }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'b0\'d1\'bc\'c6\'b7\'7c\'b5\'a5\'a6\'ac\'a8\'ec\'ab\'65\'ba\'dd\'aa\'ba}{\rtlch\fcs1 \af18\afs19 
\ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18  request }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\loch\af18\hich\af31506\dbch\f18 \'ab\'e1\'b7\'73\'bc\'57}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18         \}\hich\af31506\dbch\af18\loch\f18 ;
\par 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 // Debug }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 
\fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \loch\af18\hich\af31506\dbch\f18 \'c0\'cb\'ac\'64\'a5\'ce}{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18         }{\rtlch\fcs1 \af18\afs19 \ltrch\fcs0 \fs19\cf11\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 \hich\af31506\dbch\af18\loch\f18 //public string OrderParamsString \{ get; set; \} = "";}{\rtlch\fcs1 
\af18\afs19 \ltrch\fcs0 \fs19\cf1\kerning0\highlight8\loch\af18\dbch\af18\insrsid9206233 
\par \hich\af31506\dbch\af18\loch\f18     \}
\par 
\par 
\par \}
\par }\pard \ltrpar\ql \li0\ri0\nowidctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid9206233 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par 
\par 
\par 
\par 
\par }{\rtlch\fcs1 \af0\afs28 \ltrch\fcs0 \fs28\insrsid1995776\charrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 OrderController}{\rtlch\fcs1 \af0\afs28 \ltrch\fcs0 \fs28\insrsid1995776\charrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par 
\par }\pard \ltrpar\ql \li0\ri0\nowidctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0\pararsid1995776 {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 using FrameZone_WebApi.Shopping.DTOs;
\par \hich\af31506\dbch\af31505\loch\f31506 using FrameZone_WebApi.Shopping.Services;
\par \hich\af31506\dbch\af31505\loch\f31506 using Microsoft.AspNetCore.Http;
\par \hich\af31506\dbch\af31505\loch\f31506 using Microsoft.AspNetCore.Mvc;
\par \hich\af31506\dbch\af31505\loch\f31506 using FrameZone_WebApi.Models;
\par \hich\af31506\dbch\af31505\loch\f31506 using System.Security.Claims;
\par \hich\af31506\dbch\af31505\loch\f31506 using Microsoft.EntityFrameworkCore;
\par \hich\af31506\dbch\af31505\loch\f31506 using Microsoft.AspNetCore.Authorization;
\par 
\par \hich\af31506\dbch\af31505\loch\f31506 namespace FrameZone_WebApi.Shopping.Controllers
\par \{
\par \hich\af31506\dbch\af31505\loch\f31506     [Route("api/[controller]")]
\par \hich\af31506\dbch\af31505\loch\f31506     [ApiController]
\par \hich\af31506\dbch\af31505\loch\f31506     public class OrderController : ControllerBase
\par \hich\af31506\dbch\af31505\loch\f31506     \{
\par \hich\af31506\dbch\af31505\loch\f31506         private readonly ECPayService _ecpayService;
\par \hich\af31506\dbch\af31505\loch\f31506   \hich\af31506\dbch\af31505\loch\f31506       private readonly IConfiguration _configuration;
\par \hich\af31506\dbch\af31505\loch\f31506         private readonly ILogger<OrderController> _logger;
\par \hich\af31506\dbch\af31505\loch\f31506         private readonly AAContext _context;
\par 
\par \hich\af31506\dbch\af31505\loch\f31506         public OrderController(ECPayService ecpayService, ILogger<OrderController> logger, IConfi\hich\af31506\dbch\af31505\loch\f31506 guration configuration, AAContext context)
\par \hich\af31506\dbch\af31505\loch\f31506         \{
\par \hich\af31506\dbch\af31505\loch\f31506             _ecpayService = ecpayService;
\par \hich\af31506\dbch\af31505\loch\f31506             _configuration = configuration;
\par \hich\af31506\dbch\af31505\loch\f31506             _logger = logger;
\par \hich\af31506\dbch\af31505\loch\f31506             _context = context;
\par \hich\af31506\dbch\af31505\loch\f31506         \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         //}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b4\'fa\'b8\'d5\'a5\'ce\'a5\'69\'a5\'48\'b3\'73\'a8\'ec\'ab\'e1\'ba\'dd}
{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 OrderController
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         [HttpGet("test")]
\par \hich\af31506\dbch\af31505\loch\f31506         public IActionResult Test()
\par \hich\af31506\dbch\af31505\loch\f31506         \{
\par \hich\af31506\dbch\af31505\loch\f31506             return Ok("Test!");
\par \hich\af31506\dbch\af31505\loch\f31506         \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         //}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ab\'65\'ba\'dd\'b7\'c7\'b3\'c6\'b5\'b2\'b1\'62\'b8\'ea\'b0\'54\'a5\'e1
\'b5\'b9\'ab\'e1\'ba\'dd}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         [Authorize]
\par \hich\af31506\dbch\af31505\loch\f31506         [HttpPost("create")]
\par \hich\af31506\dbch\af31505\loch\f31506         public async Task<ActionResult<ECPayOrderParamsDto>> CreateOrder([FromBody] OrderDto order)
\par \hich\af31506\dbch\af31505\loch\f31506         \{
\par \hich\af31506\dbch\af31505\loch\f31506             long? userId = GetUserIdFromToken();
\par \hich\af31506\dbch\af31505\loch\f31506             _logger.LogInformation("Creating order for UserId: \{UserId\}", userId);
\par \hich\af31506\dbch\af31505\loch\f31506             if\hich\af31506\dbch\af31505\loch\f31506  (userId == null) 
\par \hich\af31506\dbch\af31505\loch\f31506             \{
\par \hich\af31506\dbch\af31505\loch\f31506                 _logger.LogWarning("CreateOrder failed: Unauthorized. User not found in token.");
\par \hich\af31506\dbch\af31505\loch\f31506                 return Unauthorized();
\par \hich\af31506\dbch\af31505\loch\f31506             \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             // 1. }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ab\'d8\'a5\'df\'ad\'71\'b3\'e6\'a5\'44\'aa\'ed}{\rtlch\fcs1 
\af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             var newOrder = new Order
\par \hich\af31506\dbch\af31505\loch\f31506          \hich\af31506\dbch\af31505\loch\f31506    \{
\par \hich\af31506\dbch\af31505\loch\f31506                 UserId = userId.Value,
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                 OrderStatus = "Pending Payment", // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'aa\'ec\'a9\'6c\'aa\'ac
\'ba\'41\'b3\'5d\'ac\'b0}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  Pending Payment
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                 TotalAmount = order.TotalAmount,
\par \hich\af31506\dbch\af31505\loch\f31506                 RecipientName = order.RecipientName ?? "",
\par \hich\af31506\dbch\af31505\loch\f31506                 PhoneNumber =\hich\af31506\dbch\af31505\loch\f31506  order.PhoneNumber ?? "",
\par \hich\af31506\dbch\af31505\loch\f31506                 ShippingAddress = order.ShippingAddress ?? "",
\par \hich\af31506\dbch\af31505\loch\f31506                 ShippingMethod = order.ShippingMethod ?? "",
\par \hich\af31506\dbch\af31505\loch\f31506                 CreatedAt = DateTime.Now,
\par \hich\af31506\dbch\af31505\loch\f31506                 UpdatedAt = DateTime.Now
\par \hich\af31506\dbch\af31505\loch\f31506             \};
\par 
\par \hich\af31506\dbch\af31505\loch\f31506             _context.Orders.Add(newOrder);
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             await _context.SaveChangesAsync(); // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a5\'fd\'a6\'73\'c0\'c9\'a5\'48
\'b2\'a3\'a5\'cd}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  OrderId
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             _logger.LogInformation("Order \{OrderId\} created successfully for UserId \{UserId\}.", newOrder.OrderId, userId);
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             // 2. }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ab\'d8\'a5\'df\'ad\'71\'b3\'e6\'a9\'fa\'b2\'d3}{\rtlch\fcs1 
\af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             if (order.OrderItems != null)
\par \hich\af31506\dbch\af31505\loch\f31506             \{
\par \hich\af31506\dbch\af31505\loch\f31506                 foreach (var item in order.OrderItems)
\par \hich\af31506\dbch\af31505\loch\f31506                 \{
\par \hich\af31506\dbch\af31505\loch\f31506                     var detail = new OrderDetail
\par \hich\af31506\dbch\af31505\loch\f31506                     \{
\par \hich\af31506\dbch\af31505\loch\f31506                         OrderId = newOrder.OrderId,
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506    \hich\af31506\dbch\af31505\loch\f31506                      SpecificationId = item.Id, // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\loch\af31506\hich\af31506\dbch\f31505 \'b3\'6f\'b8\'cc\'b9\'ef\'c0\'b3\'ab\'65\'ba\'dd\'b6\'c7\'a8\'d3\'aa\'ba}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  ID (}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\loch\af31506\hich\af31506\dbch\f31505 \'c0\'b3\'ac\'b0\'b3\'57\'ae\'e6}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  ID)
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                         Quantity = item.Quantity,
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                         TransactionPrice = item.Price, // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b9\'ef\'c0\'b3}{
\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  TransactionPrice }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'c4\'e6\'a6\'ec}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 

\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                         CreatedAt = DateTime.Now,
\par \hich\af31506\dbch\af31505\loch\f31506  \hich\af31506\dbch\af31505\loch\f31506                        UpdatedAt = DateTime.Now
\par \hich\af31506\dbch\af31505\loch\f31506                     \};
\par \hich\af31506\dbch\af31505\loch\f31506                     _context.OrderDetails.Add(detail);
\par \hich\af31506\dbch\af31505\loch\f31506                 \}
\par \hich\af31506\dbch\af31505\loch\f31506                 await _context.SaveChangesAsync();
\par \hich\af31506\dbch\af31505\loch\f31506             \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             // 3. }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a6\'70\'aa\'47\'ac\'4f\'b3\'66\'a8\'ec\'a5\'49\'b4\'da\'a1\'41
\'a4\'a3\'bb\'dd\'ad\'6e\'b8\'f5\'c2\'e0\'ba\'f1\'ac\'c9\'a1\'41\'aa\'bd\'b1\'b5\'b5\'b2\'a7\'f4\'a8\'c3\'a6\'5e\'b6\'c7\'aa\'c5\'b0\'d1\'bc\'c6}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  (}{\rtlch\fcs1 \af0 
\ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ab\'65\'ba\'dd\'b7\'7c\'ae\'da\'be\'da\'a6\'b9\'a7\'50\'c2\'5f\'aa\'bd\'b1\'b5\'be\'c9\'a6\'56\'a6\'a8\'a5\'5c\'ad\'b6}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\hich\af31506\dbch\af31505\loch\f31506 )
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             if (order.PaymentMethod == "COD")
\par \hich\af31506\dbch\af31505\loch\f31506             \{
\par \hich\af31506\dbch\af31505\loch\f31506                 return Ok(new ECPayOrderParamsDto());
\par \hich\af31506\dbch\af31505\loch\f31506             \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             // 4. }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b7\'c7\'b3\'c6\'ba\'f1\'ac\'c9\'ad\'6e\'aa\'ba\'b8\'ea\'b0\'54}
{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par \hich\af31506\dbch\af31505\loch\f31506             // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a5\'e6\'a9\'f6\'bd\'73\'b8\'b9\'b3\'57\'ab\'68}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\hich\af31506\dbch\af31505\loch\f31506 : FZ + 8}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a6\'ec\'ad\'71\'b3\'e6}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 ID + 6}{
\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a6\'ec\'ae\'c9\'b6\'a1}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 (}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\loch\af31506\hich\af31506\dbch\f31505 \'a4\'c0\'ac\'ed}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 )
\par \hich\af31506\dbch\af31505\loch\f31506             // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b5\'f9\'b0\'4f\'a1\'47\'b3\'6f\'b8\'cc\'a8\'cf\'a5\'ce\'a9\'54\'a9\'77\'ae\'e6\'a6\'a1}{\rtlch\fcs1 \af0 
\ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  (FZ+ID) }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ac\'4f\'ac\'b0\'a4\'46\'c5\'fd}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\hich\af31506\dbch\af31505\loch\f31506  'pay-result' }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a6\'5e\'b6\'c7\'ae\'c9\'af\'e0\'ba\'eb\'bd\'54\'a4\'cf\'b1\'c0\'b8\'ea\'ae\'c6\'ae\'77\'a4\'a4\'aa\'ba}{
\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  OrderId
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             string merchantTradeNo = "FZ" + newOrder.OrderId.ToString("D8") + DateTime.Now.ToString("HHmmss");
\par \hich\af31506\dbch\af31505\loch\f31506             if (merchantTradeNo.Length > 20) merchantTradeNo = merchan\hich\af31506\dbch\af31505\loch\f31506 tTradeNo.Substring(0, 20);
\par 
\par \hich\af31506\dbch\af31505\loch\f31506             ECPayOrderParamsDto result = _ecpayService.CreateECPayOrder(order, merchantTradeNo);
\par 
\par \hich\af31506\dbch\af31505\loch\f31506             return Ok(result);
\par \hich\af31506\dbch\af31505\loch\f31506         \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b3\'cc\'ab\'e1\'a5\'49\'b4\'da\'a7\'b9\'a6\'a8\'b3\'71\'aa\'be}{
\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  (}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ba\'f1\'ac\'c9}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\hich\af31506\dbch\af31505\loch\f31506  Server to Server)
\par \hich\af31506\dbch\af31505\loch\f31506         // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a6\'b9\'a4\'e8\'aa\'6b\'a4\'a3\'a8\'fc\'ba\'f4\'a7\'7d\'ad\'ab\'a9\'77\'a6\'56\'bc\'76\'c5\'54\'a1\'41\'ac\'4f
\'ba\'f1\'ac\'c9\'a6\'f8\'aa\'41\'be\'b9\'aa\'bd\'b1\'b5\'b5\'6f\'b0\'65\'b5\'b9\'a5\'bb\'a8\'74\'b2\'ce\'aa\'ba\'bd\'54\'bb\'7b\'b0\'54\'ae\'a7\'a1\'41\'b3\'cc\'ac\'b0\loch\af31506\hich\af31506\dbch\f31505 \'a5\'69\'be\'61\'a1\'43}{\rtlch\fcs1 \af0 
\ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         [HttpPost("pay-result")]
\par \hich\af31506\dbch\af31505\loch\f31506         [Consumes("application/x-www-form-urlencoded")]
\par \hich\af31506\dbch\af31505\loch\f31506         public async Task<IActionResult> OrderPayResult(IFormCollection result)
\par \hich\af31506\dbch\af31505\loch\f31506         \{
\par \hich\af31506\dbch\af31505\loch\f31506             //_ecpayService.HandleECPayOrderResult(result);
\par \hich\af31506\dbch\af31505\loch\f31506             _\hich\af31506\dbch\af31505\loch\f31506 logger.LogInformation("ECPay PayResult Received: \{Result\}", string.Join("&", result.Select(x => $"\{x.Key\}=\{x.Value\}")));
\par 
\par \hich\af31506\dbch\af31505\loch\f31506             string merchantTradeNo = result["MerchantTradeNo"];
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             string rtnCode = result["RtnCode"]; // 1 }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ac\'b0\'a6\'a8\'a5\'5c}{
\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par \hich\af31506\dbch\af31505\loch\f31506             \hich\af31506\dbch\af31505\loch\f31506 if (rtnCode == "1")
\par \hich\af31506\dbch\af31505\loch\f31506             \{
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                 // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b8\'d1\'aa\'52}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\hich\af31506\dbch\af31505\loch\f31506  OrderId (}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b1\'71\'b2\'c4}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  3 }{\rtlch\fcs1 
\af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a6\'ec\'b6\'7d\'a9\'6c\'a8\'fa}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  8 }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\loch\af31506\hich\af31506\dbch\f31505 \'a6\'ec}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 )
\par \hich\af31506\dbch\af31505\loch\f31506                 // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b5\'f9\'b0\'4f\'a1\'47\'b3\'7a\'b9\'4c\'b8\'d1\'aa\'52\'a5\'e6\'a9\'f6\'bd\'73\'b8\'b9\'a1\'41\'a7\'da
\'ad\'cc\'a5\'69\'a5\'48\'bd\'54\'ab\'4f\'a7\'f3\'b7\'73\'aa\'ba\'ac\'4f\'a5\'bf\'bd\'54\'aa\'ba\'a5\'bb\'a6\'61\'ad\'71\'b3\'e6\'a1\'43}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                 if (merchantTradeNo.StartsWith("FZ") && merchantTradeNo.Length >= 10)
\par \hich\af31506\dbch\af31505\loch\f31506                 \{
\par \hich\af31506\dbch\af31505\loch\f31506                     string orderIdStr = merchantTradeNo.Substring(2, 8);
\par \hich\af31506\dbch\af31505\loch\f31506                     if (int.TryParse(orderIdStr, out int orderId))
\par \hich\af31506\dbch\af31505\loch\f31506                     \{
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                         var order = await _context.Orders.FirstOrDefaultAsync(o => o.OrderId =\hich\af31506\dbch\af31505\loch\f31506 = orderId); // }{\rtlch\fcs1 \af0 
\ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a5\'fd\'ac\'64\'b8\'df\'ad\'71\'b3\'e6}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                         if (order != null)
\par \hich\af31506\dbch\af31505\loch\f31506                         \{
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             order.OrderStatus = "Pending Shipment"; // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a4\'77
\'a5\'49\'b4\'da\'a1\'41\'a7\'ef\'ac\'b0}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  Pending Shipment
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             order.UpdatedAt = DateTime.Now;
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506           \hich\af31506\dbch\af31505\loch\f31506                   // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a5\'fd
\'ac\'64\'b8\'df\'a5\'b2\'ad\'6e\'aa\'ba}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  TypeId}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a1\'41\'c1\'d7\'a7\'4b}{
\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  FK }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'bf\'f9\'bb\'7e}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             var transactionType = await _context.TransactionTypes.FirstOrDefaultAsync(t => t.TypeCode == "Payment");
\par \hich\af31506\dbch\af31505\loch\f31506                             if (transactionType == null)
\par \hich\af31506\dbch\af31505\loch\f31506                       \hich\af31506\dbch\af31505\loch\f31506       \{
\par \hich\af31506\dbch\af31505\loch\f31506                                 transactionType = new TransactionType
\par \hich\af31506\dbch\af31505\loch\f31506                                 \{
\par \hich\af31506\dbch\af31505\loch\f31506                                     TypeCode = "Payment",
\par \hich\af31506\dbch\af31505\loch\f31506                                     TypeName = "Payment",
\par \hich\af31506\dbch\af31505\loch\f31506                             \hich\af31506\dbch\af31505\loch\f31506         Description = "Payment Transaction",
\par \hich\af31506\dbch\af31505\loch\f31506                                     IsActive = true,
\par \hich\af31506\dbch\af31505\loch\f31506                                     CreatedAt = DateTime.Now,
\par \hich\af31506\dbch\af31505\loch\f31506                                     UpdatedAt = DateTime.Now
\par \hich\af31506\dbch\af31505\loch\f31506                                 \};
\par \hich\af31506\dbch\af31505\loch\f31506                                 _context.TransactionTypes.Add(transactionType);
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                                 await _context.SaveChangesAsync(); // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ab\'4f
\'a6\'73\'a5\'48\'c0\'f2\'a8\'fa}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  ID
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             \}
\par 
\par \hich\af31506\dbch\af31505\loch\f31506                             var statusType = await _context.TransactionStatusTypes.FirstOrDefaultAsync(s => s.StatusCode == "Success");
\par \hich\af31506\dbch\af31505\loch\f31506                             if (statusType == null)
\par \hich\af31506\dbch\af31505\loch\f31506                             \{
\par \hich\af31506\dbch\af31505\loch\f31506                                 status\hich\af31506\dbch\af31505\loch\f31506 Type = new TransactionStatusType
\par \hich\af31506\dbch\af31505\loch\f31506                                 \{
\par \hich\af31506\dbch\af31505\loch\f31506                                     StatusCode = "Success",
\par \hich\af31506\dbch\af31505\loch\f31506                                     StatusName = "Payment Success",
\par \hich\af31506\dbch\af31505\loch\f31506                                     Description = "Payment Su\hich\af31506\dbch\af31505\loch\f31506 ccessful",
\par \hich\af31506\dbch\af31505\loch\f31506                                     IsFinal = false,
\par \hich\af31506\dbch\af31505\loch\f31506                                     IsSuccess = true,
\par \hich\af31506\dbch\af31505\loch\f31506                                     CreatedAt = DateTime.Now,
\par \hich\af31506\dbch\af31505\loch\f31506                                     UpdatedAt = DateTime.Now
\par \hich\af31506\dbch\af31505\loch\f31506                \hich\af31506\dbch\af31505\loch\f31506                  \};
\par \hich\af31506\dbch\af31505\loch\f31506                                 _context.TransactionStatusTypes.Add(statusType);
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                                 await _context.SaveChangesAsync(); // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ab\'4f
\'a6\'73\'a5\'48\'c0\'f2\'a8\'fa}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  ID
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             \}
\par \hich\af31506\dbch\af31505\loch\f31506                             
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                  \hich\af31506\dbch\af31505\loch\f31506            //  Auto-create PaymentMethodType and PaymentMethod if missing(}{\rtlch\fcs1 \af0 \ltrch\fcs0 
\insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a6\'db\'b0\'ca\'ab\'d8\'a5\'df}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 )
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             var paymentMethodType = await _context.PaymentMethodTypes.FirstOrDefaultAsync(t => t.TypeCode == "CreditCard");
\par \hich\af31506\dbch\af31505\loch\f31506                             if (paym\hich\af31506\dbch\af31505\loch\f31506 entMethodType == null)
\par \hich\af31506\dbch\af31505\loch\f31506                             \{
\par \hich\af31506\dbch\af31505\loch\f31506                                 paymentMethodType = new PaymentMethodType
\par \hich\af31506\dbch\af31505\loch\f31506                                 \{
\par \hich\af31506\dbch\af31505\loch\f31506                                     TypeCode = "CreditCard",
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                                   \hich\af31506\dbch\af31505\loch\f31506   TypeName = "}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\loch\af31506\hich\af31506\dbch\f31505 \'ab\'48\'a5\'ce\'a5\'64}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 ",
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                                     Description = "Credit Card Payment",
\par \hich\af31506\dbch\af31505\loch\f31506                                     IsActive = true,
\par \hich\af31506\dbch\af31505\loch\f31506                                     CreatedAt = DateTime.Now,
\par \hich\af31506\dbch\af31505\loch\f31506                                     UpdatedAt = \hich\af31506\dbch\af31505\loch\f31506 DateTime.Now
\par \hich\af31506\dbch\af31505\loch\f31506                                 \};
\par \hich\af31506\dbch\af31505\loch\f31506                                 _context.PaymentMethodTypes.Add(paymentMethodType);
\par \hich\af31506\dbch\af31505\loch\f31506                                 await _context.SaveChangesAsync();
\par \hich\af31506\dbch\af31505\loch\f31506                             \}
\par 
\par \hich\af31506\dbch\af31505\loch\f31506                             var paymentMethod = await _context.PaymentMethods.FirstOrDefaultAsync(m => m.User.UserId == order.UserId && m.PaymentMethodType.TypeCode == "CreditCard" && m.CardLast4 == "ECPay");
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b3\'6f\'b8\'cc\'aa\'ba}{\rtlch\fcs1 \af0 
\ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  PaymentMetho\hich\af31506\dbch\af31505\loch\f31506 d }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b3\'71\'b1\'60\'ac\'4f\'ab\'fc\'a8\'cf\'a5\'ce
\'aa\'cc\'c0\'78\'a6\'73\'aa\'ba\'a5\'49\'b4\'da\'a4\'e8\'a6\'a1\'a1\'41\'a9\'ce\'ac\'4f\'a8\'74\'b2\'ce\'a5\'fe\'b0\'ec\'aa\'ba\'a5\'49\'b4\'da\'b4\'eb\'b9\'44}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par \hich\af31506\dbch\af31505\loch\f31506                             // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ad\'59\'a6\'b9\'aa\'ed\'ac\'4f\'a5\'ce\'a8\'d3\'b0\'4f\'bf\'fd\'a1\'75\'a5\'bb\'a6\'b8\'a5\'e6
\'a9\'f6\'a8\'cf\'a5\'ce\'aa\'ba\'a5\'49\'b4\'da\'a4\'e8\'a6\'a1\'a1\'76\'a1\'41\'ab\'68}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  logic }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\loch\af31506\hich\af31506\dbch\f31505 \'a6\'70\'a4\'55\'a1\'46\'ad\'59\'ac\'4f\'ab\'fc\'a1\'75\'a8\'74\'b2\'ce\'a4\'e4\'b4\'a9\'aa\'ba\'a5\'49\'b4\'da\'a4\'e8\'a6\'a1\'a1\'76\'a1\'41\'ab\'68\'a4\'a3\'c0\'b3\'b8\'6a\'a9\'77}{\rtlch\fcs1 \af0 \ltrch\fcs0 
\insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  UserId
\par \hich\af31506\dbch\af31505\loch\f31506                             // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ae\'da\'be\'da}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\hich\af31506\dbch\af31505\loch\f31506  Model }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a9\'77\'b8\'71\'a6\'b3}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  UserId}{
\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a1\'41\'b1\'c0\'b4\'fa\'ac\'4f\'a1\'75\'a8\'cf\'a5\'ce\'aa\'cc\'c0\'78\'a6\'73\'aa\'ba\'a5\'64\'a4\'f9}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\hich\af31506\dbch\af31505\loch\f31506 /}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a4\'e8\'a6\'a1\'a1\'76\'a1\'43}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par \hich\af31506\dbch\af31505\loch\f31506                             // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ac\'b0\'c1\'d7\'a7\'4b\'bf\'f9\'bb\'7e\'a1\'41\'a7\'da\'ad\'cc\'b3\'6f\'b8\'cc\'ab\'d8\'a5\'df
\'a4\'40\'ad\'d3\'b8\'6a\'a9\'77\'b8\'d3}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  User }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'aa\'ba\'a1\'75}{\rtlch\fcs1 \af0 
\ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 ECPay }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b9\'77\'b3\'5d\'a1\'76\'ac\'f6\loch\af31506\hich\af31506\dbch\f31505 \'bf\'fd\'a1\'41\'a9\'ce
\'ac\'64\'a7\'e4\'ac\'4a\'a6\'b3\'aa\'ba\'a1\'43}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b7\'6a\'b4\'4d\'b8\'d3\'a5\'ce\'a4\'e1\'ac\'4f
\'a7\'5f\'a6\'b3\'ba\'f1\'ac\'c9\'aa\'f7\'ac\'79\'ac\'f6\'bf\'fd\'a1\'41\'ad\'59\'b5\'4c\'ab\'68\'b7\'73\'bc\'57}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             if (paymentMethod == null)
\par \hich\af31506\dbch\af31505\loch\f31506                             \{
\par \hich\af31506\dbch\af31505\loch\f31506                                 paymentMethod = new PaymentMethod
\par \hich\af31506\dbch\af31505\loch\f31506               \hich\af31506\dbch\af31505\loch\f31506                   \{
\par \hich\af31506\dbch\af31505\loch\f31506                                     UserId = order.UserId,
\par \hich\af31506\dbch\af31505\loch\f31506                                     PaymentMethodTypeId = paymentMethodType.PaymentMethodTypeId,
\par \hich\af31506\dbch\af31505\loch\f31506                                     IsDefault = false,
\par \hich\af31506\dbch\af31505\loch\f31506                          \hich\af31506\dbch\af31505\loch\f31506            IsActive = true,
\par \hich\af31506\dbch\af31505\loch\f31506                                     CardLast4 = "1234",
\par \hich\af31506\dbch\af31505\loch\f31506                                     CardholderName = order.RecipientName ?? "ECPay User",
\par \hich\af31506\dbch\af31505\loch\f31506                                     CreatedAt = DateTime.Now,
\par \hich\af31506\dbch\af31505\loch\f31506                     \hich\af31506\dbch\af31505\loch\f31506                 UpdatedAt = DateTime.Now
\par \hich\af31506\dbch\af31505\loch\f31506                                 \};
\par \hich\af31506\dbch\af31505\loch\f31506                                 _context.PaymentMethods.Add(paymentMethod);
\par \hich\af31506\dbch\af31505\loch\f31506                                 await _context.SaveChangesAsync();
\par \hich\af31506\dbch\af31505\loch\f31506                             \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             // 1. }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'bc\'67\'a4\'4a}{\rtlch\fcs1 \af0 \ltrch\fcs0 
\insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  PaymentTransaction
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             var transaction = new PaymentTransaction
\par \hich\af31506\dbch\af31505\loch\f31506                             \{
\par \hich\af31506\dbch\af31505\loch\f31506                                 UserId = order.UserId,
\par \hich\af31506\dbch\af31505\loch\f31506                                 PaymentMethodI\hich\af31506\dbch\af31505\loch\f31506 d = paymentMethod.PaymentMethodId, 
\par \hich\af31506\dbch\af31505\loch\f31506                                 TransactionTypeId = transactionType.TransactionTypeId,
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                                 TransactionNo = merchantTradeNo, // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a8\'cf
\'a5\'ce\'b0\'d3\'a9\'b1\'a5\'e6\'a9\'f6\'bd\'73\'b8\'b9}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                                 Amount = order.TotalAmou\hich\af31506\dbch\af31505\loch\f31506 nt,
\par \hich\af31506\dbch\af31505\loch\f31506                                 Currency = "TWD",
\par \hich\af31506\dbch\af31505\loch\f31506                                 Description = "ECPay Payment",
\par \hich\af31506\dbch\af31505\loch\f31506                                 MerchantTradeNo = merchantTradeNo,
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                                 GatewayTransactionId = result["TradeNo"]\hich\af31506\dbch\af31505\loch\f31506 , // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\loch\af31506\hich\af31506\dbch\f31505 \'ba\'f1\'ac\'c9\'aa\'ba\'a5\'e6\'a9\'f6\'bd\'73\'b8\'b9}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                                 GatewayName = "ECPay",
\par \hich\af31506\dbch\af31505\loch\f31506                                 CreatedAt = DateTime.Now
\par \hich\af31506\dbch\af31505\loch\f31506                             \};
\par \hich\af31506\dbch\af31505\loch\f31506                             
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                             // 2. }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'bc\'67\'a4\'4a}{\rtlch\fcs1 \af0 \ltrch\fcs0 
\insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  TransactionStatusLog
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506              \hich\af31506\dbch\af31505\loch\f31506                var statusLog = new TransactionStatusLog
\par \hich\af31506\dbch\af31505\loch\f31506                             \{
\par \hich\af31506\dbch\af31505\loch\f31506                                 Transaction = transaction,
\par \hich\af31506\dbch\af31505\loch\f31506                                 StatusTypeId = statusType.StatusTypeId,
\par \hich\af31506\dbch\af31505\loch\f31506                                 StatusM\hich\af31506\dbch\af31505\loch\f31506 essage = "Payment Success",
\par \hich\af31506\dbch\af31505\loch\f31506                                 GatewayResponse = string.Join("&", result.Select(x => $"\{x.Key\}=\{x.Value\}")),
\par \hich\af31506\dbch\af31505\loch\f31506                                 CreatedAt = DateTime.Now
\par \hich\af31506\dbch\af31505\loch\f31506                             \};
\par 
\par \hich\af31506\dbch\af31505\loch\f31506                             _\hich\af31506\dbch\af31505\loch\f31506 context.PaymentTransactions.Add(transaction);
\par \hich\af31506\dbch\af31505\loch\f31506                             _context.TransactionStatusLogs.Add(statusLog);
\par 
\par \hich\af31506\dbch\af31505\loch\f31506                             await _context.SaveChangesAsync();
\par \hich\af31506\dbch\af31505\loch\f31506                             _logger.LogInformation("Order \{OrderId\} status updated and Transaction recorded.", orderId);
\par \hich\af31506\dbch\af31505\loch\f31506                         \}
\par \hich\af31506\dbch\af31505\loch\f31506                     \}
\par \hich\af31506\dbch\af31505\loch\f31506                 \}
\par \hich\af31506\dbch\af31505\loch\f31506             \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             return Content("1|OK");  // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a7\'69\'b6\'44\'ba\'f1\'ac\'c9\'a6\'b3
\'a6\'ac\'a8\'ec\'b3\'71\'aa\'be\'a1\'41\'ad\'59\'a8\'53\'a6\'5e\'b6\'c7}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  1|OK }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 
\'ba\'f1\'ac\'c9\'b7\'7c\'ab\'f9\'c4\'f2\'ad\'ab\'b5\'6f}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         //}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a4\'a4\'c2\'e0\'ad\'b6\'ad\'b1\'a1\'41\'a5\'ce\'b3\'6f\'ad\'d3\'a4\'e8
\'a6\'a1\'a4\'a3\'bb\'dd\loch\af31506\hich\af31506\dbch\f31505 \'ab\'65\'ba\'dd\'b3\'73\'b1\'b5\'b0\'f0\'aa\'ba\'bc\'67\'aa\'6b}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par \hich\af31506\dbch\af31505\loch\f31506         // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a7\'50\'c2\'5f\'a5\'49\'b4\'da\'a6\'a8\'a5\'5c\'a9\'ce\'a5\'a2\'b1\'d1\'ad\'6e\'ad\'ab\'be\'c9\'a8\'ec\'ad\'fe
\'ad\'d3\'ad\'b6\'ad\'b1}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  (}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ba\'f1\'ac\'c9}{\rtlch\fcs1 \af0 \ltrch\fcs0 
\insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  Client to Server)
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         [HttpPost("success-redirect")]
\par \hich\af31506\dbch\af31505\loch\f31506         [Consumes("application/x-www-form-urlencoded")]
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         public IActionResult OrderSuccessRedirect() // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b2\'be\'b0\'a3}{
\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  asyn\hich\af31506\dbch\af31505\loch\f31506 c}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a1\'41\'a6\'5d\'ac\'b0\'b3\'6f\'b8\'cc
\'a5\'75\'b0\'b5\'be\'c9\'a6\'56}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         \{
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ba\'f1\'ac\'c9}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\hich\af31506\dbch\af31505\loch\f31506  POST }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a6\'5e\'a8\'d3\'aa\'ba\'a9\'d2\'a6\'b3\'b0\'d1\'bc\'c6\'b3\'a3\'a6\'62}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\hich\af31506\dbch\af31505\loch\f31506  Request.Form }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b8\'cc\'ad\'b1}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             var merchantTradeNo = Request.Form["MerchantTradeNo"];
\par \hich\af31506\dbch\af31505\loch\f31506             var rtnCode = Request.Form["RtnCode"];
\par 
\par \hich\af31506\dbch\af31505\loch\f31506             string redirectUrl = "";
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a7\'50\'c2\'5f\'ac\'4f\'a7\'5f\'a6\'a8\'a5\'5c}{\rtlch\fcs1 \af0 
\ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  (RtnCod\hich\af31506\dbch\af31505\loch\f31506 e == "1" }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a5\'4e\'aa\'ed\'a6\'a8\'a5\'5c}{\rtlch\fcs1 
\af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 )
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             if (rtnCode == "1")
\par \hich\af31506\dbch\af31505\loch\f31506             \{
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                 _logger.LogInformation("}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ba\'f1\'ac\'c9\'a5\'49\'b4\'da\'a6\'a8
\'a5\'5c\'a1\'41\'b7\'c7\'b3\'c6\'a4\'a4\'c2\'e0\'a6\'5e}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  localhost");
\par \hich\af31506\dbch\af31505\loch\f31506                 // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'be\'c9\'a6\'56\'ab\'65\'ba\'dd\'aa\'ba\'a6\'a8\'a5\'5c\'ad\'b6\'ad\'b1\'a1\'41\'a8\'c3\'b1\'61\'a4\'57
\'a5\'e6\'a9\'f6\'bd\'73\'b8\'b9\'a8\'d1\'ab\'65\'ba\'dd\'ac\'64\'b8\'df}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                 redirectUrl = $"http://localhost:4200/order-success?tradeNo=\{merchantTr\hich\af31506\dbch\af31505\loch\f31506 adeNo\}";
\par \hich\af31506\dbch\af31505\loch\f31506             \}
\par \hich\af31506\dbch\af31505\loch\f31506             else
\par \hich\af31506\dbch\af31505\loch\f31506             \{
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                 _logger.LogWarning("}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ba\'f1\'ac\'c9\'a5\'49\'b4\'da\'a5\'a2
\'b1\'d1\'a9\'ce\'a8\'cf\'a5\'ce\'aa\'cc\'a8\'fa\'ae\'f8}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 ");
\par \hich\af31506\dbch\af31505\loch\f31506                 // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'be\'c9\'a6\'56\'ab\'65\'ba\'dd\'aa\'ba\'a5\'a2\'b1\'d1\'ad\'b6\'ad\'b1\'a9\'ce\'c1\'ca\'aa\'ab\'ad\'ba
\'ad\'b6}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                 redirectUrl = "http://localhost:4200/shopping/home";
\par \hich\af31506\dbch\af31505\loch\f31506             \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ad\'ab\'c2\'49\'a1\'47\'a7\'51\'a5\'ce\'c2\'73\'c4\'fd\'be\'b9
\'bb\'7b\'b1\'6f}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  localhost }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'aa\'ba\'af\'53\'a9\'ca\'b6\'69\'a6\'e6\'a4\'a4\'c2\'e0
}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506             return Content($"<script>window.location.href='\{redirectUrl\}';</script>", "text/html");
\par \hich\af31506\dbch\af31505\loch\f31506         \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a8\'fa\'b1\'6f\'b8\'d3\'b7\'7c\'ad\'fb\'c0\'78\'a6\'73\'aa\'ba\'a8\'fa
\'b3\'66\'aa\'f9\'a5\'ab\'b8\'ea\'ae\'c6}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         [Authorize]
\par \hich\af31506\dbch\af31505\loch\f31506         [HttpGet("pickup-stores")]
\par \hich\af31506\dbch\af31505\loch\f31506         public async\hich\af31506\dbch\af31505\loch\f31506  Task<ActionResult<IEnumerable<PickupStoreDto>>> GetPickupStores()
\par \hich\af31506\dbch\af31505\loch\f31506         \{
\par \hich\af31506\dbch\af31505\loch\f31506             long? userId = GetUserIdFromToken();
\par \hich\af31506\dbch\af31505\loch\f31506             if (userId == null) return Unauthorized();
\par 
\par \hich\af31506\dbch\af31505\loch\f31506             var stores = await _context.PickupConvenienceStores
\par \hich\af31506\dbch\af31505\loch\f31506           \hich\af31506\dbch\af31505\loch\f31506       .Where(s => s.UserId == userId.Value)
\par \hich\af31506\dbch\af31505\loch\f31506                 .OrderByDescending(s => s.IsDefault)
\par \hich\af31506\dbch\af31505\loch\f31506                 .Select(s => new PickupStoreDto
\par \hich\af31506\dbch\af31505\loch\f31506                 \{
\par \hich\af31506\dbch\af31505\loch\f31506                     ConvenienceStoreId = s.ConvenienceStoreId,
\par \hich\af31506\dbch\af31505\loch\f31506                     Convenienc\hich\af31506\dbch\af31505\loch\f31506 eStoreName = s.ConvenienceStoreName,
\par \hich\af31506\dbch\af31505\loch\f31506                     ConvenienceStoreCode = s.ConvenienceStoreCode,
\par \hich\af31506\dbch\af31505\loch\f31506                     RecipientName = s.RecipientName,
\par \hich\af31506\dbch\af31505\loch\f31506                     PhoneNumber = s.PhoneNumber,
\par \hich\af31506\dbch\af31505\loch\f31506                     IsDefault = s.IsDefault,
\par \hich\af31506\dbch\af31505\loch\f31506      \hich\af31506\dbch\af31505\loch\f31506                CreatedAt = s.CreatedAt
\par \hich\af31506\dbch\af31505\loch\f31506                 \})
\par \hich\af31506\dbch\af31505\loch\f31506                 .ToListAsync();
\par 
\par \hich\af31506\dbch\af31505\loch\f31506             return Ok(stores);
\par \hich\af31506\dbch\af31505\loch\f31506         \}
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a8\'fa\'b1\'6f\'b7\'ed\'ab\'65\'b5\'6e\'a4\'4a\'b7\'7c\'ad\'fb\'aa\'ba
\'a7\'b9\'be\'e3\'ad\'71\'b3\'e6\'be\'fa\'a5\'76\'ac\'f6\'bf\'fd}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         [Authorize]
\par \hich\af31506\dbch\af31505\loch\f31506         [HttpGet("my-orders")]
\par \hich\af31506\dbch\af31505\loch\f31506         public async Task<ActionResult> GetMyOrders()
\par \hich\af31506\dbch\af31505\loch\f31506         \{
\par \hich\af31506\dbch\af31505\loch\f31506             long? userId = GetUserIdFromToken();
\par \hich\af31506\dbch\af31505\loch\f31506             if (userId == null) return Unauthorized();
\par 
\par \hich\af31506\dbch\af31505\loch\f31506             var orders = await _context.Orders
\par \hich\af31506\dbch\af31505\loch\f31506                 .Where(o => o.UserId == \hich\af31506\dbch\af31505\loch\f31506 userId.Value)
\par \hich\af31506\dbch\af31505\loch\f31506                 .Include(o => o.OrderDetails)
\par \hich\af31506\dbch\af31505\loch\f31506                     .ThenInclude(d => d.Specification)
\par \hich\af31506\dbch\af31505\loch\f31506                         .ThenInclude(s => s.Product)
\par \hich\af31506\dbch\af31505\loch\f31506                             .ThenInclude(p => p.ProductImages)
\par \hich\af31506\dbch\af31505\loch\f31506                 .Include(\hich\af31506\dbch\af31505\loch\f31506 o => o.OrderDetails)
\par \hich\af31506\dbch\af31505\loch\f31506                     .ThenInclude(d => d.Specification)
\par \hich\af31506\dbch\af31505\loch\f31506                         .ThenInclude(s => s.Product)
\par \hich\af31506\dbch\af31505\loch\f31506                             .ThenInclude(p => p.User)
\par \hich\af31506\dbch\af31505\loch\f31506                                 .ThenInclude(u => u.UserProfile)
\par \hich\af31506\dbch\af31505\loch\f31506         \hich\af31506\dbch\af31505\loch\f31506         .OrderByDescending(o => o.CreatedAt)
\par \hich\af31506\dbch\af31505\loch\f31506                 .ToListAsync();
\par 
\par \hich\af31506\dbch\af31505\loch\f31506             var result = orders.Select(o => \{
\par \hich\af31506\dbch\af31505\loch\f31506                 var firstProduct = o.OrderDetails.FirstOrDefault();
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                 var sellerName = firstProduct?.Specification?.Pr\hich\af31506\dbch\af31505\loch\f31506 oduct?.User?.UserProfile?.DisplayName ?? "FrameZone }{\rtlch\fcs1 
\af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ba\'eb\'bf\'ef\'bd\'e6\'b3\'f5}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 ";
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                 
\par \hich\af31506\dbch\af31505\loch\f31506                 return new \{
\par \hich\af31506\dbch\af31505\loch\f31506                     id = "ORD" + o.OrderId.ToString("D6"),
\par \hich\af31506\dbch\af31505\loch\f31506                     orderId = o.OrderId,
\par \hich\af31506\dbch\af31505\loch\f31506                     shopName = sellerName,
\par \hich\af31506\dbch\af31505\loch\f31506                     status = o.OrderStatus == "Pending Payment" ? "pay" : 
\par \hich\af31506\dbch\af31505\loch\f31506                              o.OrderStatus == "Pending Shipment" ? "ship" : "done",
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                     statusText = o.OrderStatus == "Pending Payment" ? "}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ab\'dd
\'a5\'49\'b4\'da}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 " : 
\par \hich\af31506\dbch\af31505\loch\f31506                   \hich\af31506\dbch\af31505\loch\f31506                o.OrderStatus == "Pending Shipment" ? "}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'ab\'dd\'a5\'58
\'b3\'66}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 " : "}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a4\'77\'a7\'b9\'a6\'a8}{\rtlch\fcs1 \af0 \ltrch\fcs0 
\insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 ",
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                     totalAmount = o.TotalAmount,
\par \hich\af31506\dbch\af31505\loch\f31506                     createdAt = o.CreatedAt,
\par \hich\af31506\dbch\af31505\loch\f31506                     products = o.OrderDetails.Select(d => new \{
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                         name =\hich\af31506\dbch\af31505\loch\f31506  d.Specification?.Product?.ProductName ?? "}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\loch\af31506\hich\af31506\dbch\f31505 \'a5\'bc\'aa\'be\'b0\'d3\'ab\'7e}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 ",
\par \hich\af31506\dbch\af31505\loch\f31506                         spec = "}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b9\'77\'b3\'5d\'b3\'57\'ae\'e6}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\hich\af31506\dbch\af31505\loch\f31506 ", // }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'bc\'c8\'ae\'c9\'a9\'54\'a9\'77\'a1\'41\'a6\'5d\'b8\'ea\'ae\'c6\'ae\'77\'b5\'b2\'ba\'63\'b8\'fb\'b2\'60}{\rtlch\fcs1 \af0 
\ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506                         price = d.TransactionPrice,
\par \hich\af31506\dbch\af31505\loch\f31506                         quantity = d.Quantity,
\par \hich\af31506\dbch\af31505\loch\f31506                         productId = d.Specification\hich\af31506\dbch\af31505\loch\f31506 ?.ProductId ?? 0,
\par \hich\af31506\dbch\af31505\loch\f31506                         imageUrl = d.Specification?.Product?.ProductImages?.FirstOrDefault(i => i.IsMainImage)?.ImageUrl 
\par \hich\af31506\dbch\af31505\loch\f31506                                    ?? d.Specification?.Product?.ProductImages?.FirstOrDefault()?.ImageUrl
\par \hich\af31506\dbch\af31505\loch\f31506           \hich\af31506\dbch\af31505\loch\f31506                          ?? "https://placehold.co/80x80?text=No+Image"
\par \hich\af31506\dbch\af31505\loch\f31506                     \})
\par \hich\af31506\dbch\af31505\loch\f31506                 \};
\par \hich\af31506\dbch\af31505\loch\f31506             \});
\par 
\par \hich\af31506\dbch\af31505\loch\f31506             return Ok(result);
\par \hich\af31506\dbch\af31505\loch\f31506         \}
\par 
\par \hich\af31506\dbch\af31505\loch\f31506         #region Helpers
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 //}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'c3\'d1\'a7\'4f\'b7\'ed\'ab\'65\'ac\'4f\'ad\'fe\'a6\'ec\'b7\'7c\'ad\'fb\'a6\'62
\'b5\'b2\'b1\'62}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par \hich\af31506\dbch\af31505\loch\f31506 //}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b7\'ed\'b7\'7c\'ad\'fb\'b5\'6e\'a4\'4a\'ab\'e1\'a1\'41\'c2\'73\'c4\'fd\'be\'b9\'b5\'6f\'b0\'65\'bd\'d0\'a8\'44\'ae\'c9\'b7\'7c
\'b1\'61\'b5\'db\'a4\'40\'ad\'d3\'a5\'5b\'b1\'4b\'aa\'ba\'be\'cc\'c3\'d2\'a1\'5d}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 Token}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\loch\af31506\hich\af31506\dbch\f31505 \'a1\'5e\'a1\'43}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 GetUserIdF\hich\af31506\dbch\af31505\loch\f31506 romToken()}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\loch\af31506\hich\af31506\dbch\f31505 \'a4\'e8\'aa\'6b\'aa\'ba\'a7\'40\'a5\'ce\'b4\'4e\'ac\'4f\'b1\'71\'b3\'6f\'ad\'d3\'be\'cc\'c3\'d2\'a4\'a4\'b8\'d1\'aa\'52\'a5\'58\'b8\'d3\'b7\'7c\'ad\'fb\'a6\'62\'ba\'f4\'af\'b8\'b8\'ea\'ae\'c6\'ae\'77\'b8\'cc\'aa\'ba
}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506  }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'b0\'df\'a4\'40\'c3\'d1\'a7\'4f\'bd\'58\'a1\'5d}{\rtlch\fcs1 \af0 \ltrch\fcs0 
\insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506 UserId}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \loch\af31506\hich\af31506\dbch\f31505 \'a1\'5e}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \hich\af31506\dbch\af31505\loch\f31506         private long? GetUserIdFromToken()
\par \hich\af31506\dbch\af31505\loch\f31506         \{
\par \hich\af31506\dbch\af31505\loch\f31506             try
\par \hich\af31506\dbch\af31505\loch\f31506             \{
\par \hich\af31506\dbch\af31505\loch\f31506                 var userIdClaim = User.FindFirst(ClaimTypes.NameIdentifier)?.Value;
\par \hich\af31506\dbch\af31505\loch\f31506                 if (string.IsNullOrEmpty(userIdClaim))
\par \hich\af31506\dbch\af31505\loch\f31506                 \{
\par \hich\af31506\dbch\af31505\loch\f31506                     return null;
\par \hich\af31506\dbch\af31505\loch\f31506                 \}
\par 
\par \hich\af31506\dbch\af31505\loch\f31506                 if (long.TryParse(userIdClaim, out var userId))
\par \hich\af31506\dbch\af31505\loch\f31506                 \{
\par \hich\af31506\dbch\af31505\loch\f31506                     return userId;
\par \hich\af31506\dbch\af31505\loch\f31506               \hich\af31506\dbch\af31505\loch\f31506   \}
\par 
\par \hich\af31506\dbch\af31505\loch\f31506                 return null;
\par \hich\af31506\dbch\af31505\loch\f31506             \}
\par \hich\af31506\dbch\af31505\loch\f31506             catch
\par \hich\af31506\dbch\af31505\loch\f31506             \{
\par \hich\af31506\dbch\af31505\loch\f31506                 return null;
\par \hich\af31506\dbch\af31505\loch\f31506             \}
\par \hich\af31506\dbch\af31505\loch\f31506         \}
\par 
\par \hich\af31506\dbch\af31505\loch\f31506         #endregion
\par \hich\af31506\dbch\af31505\loch\f31506     \}
\par }\pard \ltrpar\ql \li0\ri0\nowidctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776 \}}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid1995776\charrsid1995776 
\par }{\*\themedata 504b030414000600080000002100e9de0fbfff0000001c020000130000005b436f6e74656e745f54797065735d2e786d6cac91cb4ec3301045f748fc83e52d4a
9cb2400825e982c78ec7a27cc0c8992416c9d8b2a755fbf74cd25442a820166c2cd933f79e3be372bd1f07b5c3989ca74aaff2422b24eb1b475da5df374fd9ad
5689811a183c61a50f98f4babebc2837878049899a52a57be670674cb23d8e90721f90a4d2fa3802cb35762680fd800ecd7551dc18eb899138e3c943d7e503b6
b01d583deee5f99824e290b4ba3f364eac4a430883b3c092d4eca8f946c916422ecab927f52ea42b89a1cd59c254f919b0e85e6535d135a8de20f20b8c12c3b0
0c895fcf6720192de6bf3b9e89ecdbd6596cbcdd8eb28e7c365ecc4ec1ff1460f53fe813d3cc7f5b7f020000ffff0300504b030414000600080000002100a5d6
a7e7c0000000360100000b0000005f72656c732f2e72656c73848fcf6ac3300c87ef85bd83d17d51d2c31825762fa590432fa37d00e1287f68221bdb1bebdb4f
c7060abb0884a4eff7a93dfeae8bf9e194e720169aaa06c3e2433fcb68e1763dbf7f82c985a4a725085b787086a37bdbb55fbc50d1a33ccd311ba548b6309512
0f88d94fbc52ae4264d1c910d24a45db3462247fa791715fd71f989e19e0364cd3f51652d73760ae8fa8c9ffb3c330cc9e4fc17faf2ce545046e37944c69e462
a1a82fe353bd90a865aad41ed0b5b8f9d6fd010000ffff0300504b0304140006000800000021006b799616830000008a0000001c0000007468656d652f746865
6d652f7468656d654d616e616765722e786d6c0ccc4d0ac3201040e17da17790d93763bb284562b2cbaebbf600439c1a41c7a0d29fdbd7e5e38337cedf14d59b
4b0d592c9c070d8a65cd2e88b7f07c2ca71ba8da481cc52c6ce1c715e6e97818c9b48d13df49c873517d23d59085adb5dd20d6b52bd521ef2cdd5eb9246a3d8b
4757e8d3f729e245eb2b260a0238fd010000ffff0300504b030414000600080000002100338329c3a7070000d0200000160000007468656d652f7468656d652f
7468656d65312e786d6cec595f8b1bc9117f0fe43b0cf32eebdf8cfe2c960f692479cfdeb58d253bdc63afd49a696fcfb4986eed5a1c86c3f772811008dc1d09
e42079ca43087790839884900fe363cde5f22152dd339ae9965af6eee28009bb8265a6f5abea5f57555795ba6f7ff43ca6ce194e396149cfaddfaab90e4e666c
4e92b0e73e998e2b1dd7e10225734459827bee1a73f7a33b3fffd96d7420221c6307e4137e807a6e24c4f2a05ae5331846fc165be204be5bb03446025ed3b03a
4fd139e88d69b551abb5aa312289eb242806b50f170b32c3ce0ffffce2e277dffef0ea1f3ffef157ee9dcd1c230a132582cb81194d2772066c082aecfcb42e11
7ccd039a3a6788f65c986ececea7f8b9701d8ab8802f7a6e4dfdb9d53bb7abe82017a2628fac2637567fb95c2e303f6da839d3f0a498d4f37cafd52ff42b0015
bbb8517bd41ab50a7d0a8066335869c6c5d4d96e045e8ed540d9a345f7b03d6cd60dbca6bfb9c3b9efcb8f8157a04cbfb7831f8f03b0a28157a00cefefe0fd41
773034f52b50866fede0dbb5fed06b1bfa1528a22439dd41d7fc5633d8acb6802c183db4c2bbbe376e3772e5250aa2a1882e39c58225625facc5e8194bc70090
408a04491cb15ee2059a413007889293943847248c20f09628611c866b8ddab8d684fff2e3a927e551748091262d790113be3324f9387c9692a5e8b9f740abab
412e5ebd7afdf2fbd72ffff6faf3cf5fbffc369f5ba932e40e5112ea723ffde937fff9e633e7df7ffdc34f5f7e954dbd8de73afecd5f7ef9e6efff7a9b7a5871
698a8bafbf7bf3fd7717bffdf58f7ffed2a2bd9fa2131d3e2531e6ce037cee3c66312cd0c21f9fa45793984688e812fd24e4284172168bfe91880cf48335a2c8
821b60d38e4f53483536e0ddd53383f0244a57825834de8f620378cc181db0d46a85fb722ecdccd35512da274f573aee314267b6b90394185e1ead969063894d
65106183e6238a1281429c60e1c8efd829c696d57d428861d763324b19670be17c429c012256934cc989114da5d02189c12f6b1b41f0b7619be3a7ce8051dbaa
87f8cc44c2de40d4427e8aa961c6bb6825506c53394531d50d7e844464233959a7331d37e2023c1d62ca9cd11c736e937998c27a35a7df87346377fb315dc726
3215e4d4a6f30831a62387ec348850bcb46127248974ecc7fc144214398f98b0c18f99b943e43bf801257bddfd9460c3ddefce064f20c3ea94ca0091dfac528b
2fef6266c4ef644d1708db524d3f8d8d14db4f89353a06abd008ed238c293a47738c9d271f5b180cd8d2b07949fa5e0459e510db02eb1e326355be2798634735
37bb79f2887023642738647bf81cafb712cf1a25314af7697e005ed76d3e825217db02e0219d9deac007045a418817ab511e72d0a105f75ead8f22641430f9ce
edf1ba4e0dff5d668fc1be7c66d0b8c4be04197c651948ecbacc5b6d3345d498a00c9829822ec3966e41c4707f29228bab125b59e516e6a62ddd00dd91d1f4c4
24796707b4d5fbf8ffbbde073a8c8bdf7f63d96cefa7dfb12b3692d5153b9d7dc9e470abbfd987dbee6a0296cec987dfd40cd12a7984a18eec66ac9b9ee6a6a7
71ffef7b9a7dfbf9a693d9d76fdc74322e7418379d4c7eb8f27e3a99b27981be461e7864073dead827de7beab320944ec49ae223ae0e7e38fc9e998f6150caa9
834f5c9c022e237894650e263070618a948c9332f10b22a2498496703a5477a59290e7aa43ee2c19874323356cd52df174151fb37976d859afcb83cdacb27224
caf19a5f8cc34195c8d0ad76798057a8576c4375d0ba212065af42429bcc24d1b490686f06a591d4b12e18cd4242adecbdb0e85a5874a4fa8dab765800b5c22b
f083db819fe93dd7f7400484e03c0e9af3b9f453e6ea8d779533dfa7a7f719d3880068b03711507aba2bb9ee5d9e5c5d166a97f0b441420b379384b28c6af078
043f83f3e894a397a171555f774b971af4a429d47c105a258d76e76d2caeeb6b90dbce0d34d133054d9cf39edb6afa103233b4ecb90b383486c77809b1c3e56f
2e4443b880998934dbf0d7c92ccb948b21e25166709574b26c101381538792b8e7cae5176ea089ca218a5bbd0109e18325d785b4f2a19103a79b4ec68b059e09
ddedda88b474f60a193ecb15d66f95f8f5c15292adc0dd93687eee9cd055fa184188f9edba34e09c70b83ba867d69c13b80c2b1259197f5b85294fbbfa6d948a
a16c1cd16584f28aa227f30cae52794147bd1536d0def23583413593e485f02494055637aa514d8baa9171d85b75df2d242da725cdb2661a5945564d7b163366
d894812d5b5eafc86bac3626869ca657f82c756fa7dcee26d76df5094595008317f6b354dd4b14048d5a3999414d32de4dc33267e7a366edd82cf01dd42e5324
b4acdfdaa8ddb25b5123acd3c1e0b52a3fc86d472d0c2d367da5b2b4ba3cd72fb6d9c933481e43e872575470e54ab8b64e11344413d593646903b6c873916f0d
78725629e9b99fd6fcbe1734fca052ebf8a38ad7f46a958edf6f56fabedfac8ffc7a6d3868bc80c222a2b8ee6717f763b8c0a0ebfcfa5e8def5ce1c79b3b9a5b
33165799baa2af2ae2ea0abfdeb05de14fe5e5bceb10483a9fb61ae36eb33b6855bacdfeb8e20d079d4a37680d2ac356d01e8e8781dfe98e5fb8ce99027bfd66
e0b5469d4aab1e0415af5593f43bdd4adb6b34fa5ebbdf1979fd17791b032bcfd2476e0b30afe275e7bf000000ffff0300504b0304140006000800000021000d
d1909fb60000001b010000270000007468656d652f7468656d652f5f72656c732f7468656d654d616e616765722e786d6c2e72656c73848f4d0ac2301484f782
77086f6fd3ba109126dd88d0add40384e4350d363f2451eced0dae2c082e8761be9969bb979dc9136332de3168aa1a083ae995719ac16db8ec8e4052164e89d9
3b64b060828e6f37ed1567914b284d262452282e3198720e274a939cd08a54f980ae38a38f56e422a3a641c8bbd048f7757da0f19b017cc524bd62107bd50019
96509affb3fd381a89672f1f165dfe514173d9850528a2c6cce0239baa4c04ca5bbabac4df000000ffff0300504b01022d0014000600080000002100e9de0fbf
ff0000001c0200001300000000000000000000000000000000005b436f6e74656e745f54797065735d2e786d6c504b01022d0014000600080000002100a5d6a7
e7c0000000360100000b00000000000000000000000000300100005f72656c732f2e72656c73504b01022d00140006000800000021006b799616830000008a00
00001c00000000000000000000000000190200007468656d652f7468656d652f7468656d654d616e616765722e786d6c504b01022d0014000600080000002100
338329c3a7070000d02000001600000000000000000000000000d60200007468656d652f7468656d652f7468656d65312e786d6c504b01022d00140006000800
000021000dd1909fb60000001b0100002700000000000000000000000000b10a00007468656d652f7468656d652f5f72656c732f7468656d654d616e616765722e786d6c2e72656c73504b050600000000050005005d010000ac0b00000000}
{\*\colorschememapping 3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d3822207374616e64616c6f6e653d22796573223f3e0d0a3c613a636c724d
617020786d6c6e733a613d22687474703a2f2f736368656d61732e6f70656e786d6c666f726d6174732e6f72672f64726177696e676d6c2f323030362f6d6169
6e22206267313d226c743122207478313d22646b3122206267323d226c743222207478323d22646b322220616363656e74313d22616363656e74312220616363
656e74323d22616363656e74322220616363656e74333d22616363656e74332220616363656e74343d22616363656e74342220616363656e74353d22616363656e74352220616363656e74363d22616363656e74362220686c696e6b3d22686c696e6b2220666f6c486c696e6b3d22666f6c486c696e6b222f3e}
{\*\latentstyles\lsdstimax375\lsdlockeddef0\lsdsemihiddendef0\lsdunhideuseddef0\lsdqformatdef0\lsdprioritydef99{\lsdlockedexcept \lsdqformat1 \lsdpriority0 \lsdlocked0 Normal;\lsdqformat1 \lsdpriority9 \lsdlocked0 heading 1;
\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 2;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 3;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 4;
\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 5;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 6;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 7;
\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 8;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority9 \lsdlocked0 heading 9;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 1;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 3;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 4;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 5;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 6;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 7;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 8;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index 9;
\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 1;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 2;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 3;
\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 4;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 5;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 6;
\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 7;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 8;\lsdsemihidden1 \lsdunhideused1 \lsdpriority39 \lsdlocked0 toc 9;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Normal Indent;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 footnote text;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 annotation text;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 header;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 footer;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 index heading;\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority35 \lsdlocked0 caption;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 table of figures;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 envelope address;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 envelope return;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 footnote reference;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 annotation reference;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 line number;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 page number;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 endnote reference;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 endnote text;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 table of authorities;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 macro;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 toa heading;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Bullet;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Number;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List 3;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List 4;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List 5;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Bullet 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Bullet 3;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Bullet 4;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Bullet 5;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Number 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Number 3;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Number 4;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Number 5;\lsdqformat1 \lsdpriority10 \lsdlocked0 Title;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Closing;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Signature;\lsdsemihidden1 \lsdunhideused1 \lsdpriority1 \lsdlocked0 Default Paragraph Font;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text Indent;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Continue;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Continue 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Continue 3;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Continue 4;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 List Continue 5;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Message Header;\lsdqformat1 \lsdpriority11 \lsdlocked0 Subtitle;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Salutation;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Date;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text First Indent;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text First Indent 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Note Heading;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text 3;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text Indent 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Body Text Indent 3;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Block Text;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Hyperlink;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 FollowedHyperlink;\lsdqformat1 \lsdpriority22 \lsdlocked0 Strong;
\lsdqformat1 \lsdpriority20 \lsdlocked0 Emphasis;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Document Map;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Plain Text;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 E-mail Signature;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Top of Form;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Bottom of Form;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Normal (Web);\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Acronym;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Address;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Cite;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Code;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Definition;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Keyboard;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Preformatted;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Sample;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Typewriter;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 HTML Variable;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 annotation subject;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 No List;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Outline List 1;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Outline List 2;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Outline List 3;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Balloon Text;\lsdpriority39 \lsdlocked0 Table Grid;
\lsdsemihidden1 \lsdlocked0 Placeholder Text;\lsdqformat1 \lsdpriority1 \lsdlocked0 No Spacing;\lsdpriority60 \lsdlocked0 Light Shading;\lsdpriority61 \lsdlocked0 Light List;\lsdpriority62 \lsdlocked0 Light Grid;
\lsdpriority63 \lsdlocked0 Medium Shading 1;\lsdpriority64 \lsdlocked0 Medium Shading 2;\lsdpriority65 \lsdlocked0 Medium List 1;\lsdpriority66 \lsdlocked0 Medium List 2;\lsdpriority67 \lsdlocked0 Medium Grid 1;\lsdpriority68 \lsdlocked0 Medium Grid 2;
\lsdpriority69 \lsdlocked0 Medium Grid 3;\lsdpriority70 \lsdlocked0 Dark List;\lsdpriority71 \lsdlocked0 Colorful Shading;\lsdpriority72 \lsdlocked0 Colorful List;\lsdpriority73 \lsdlocked0 Colorful Grid;\lsdpriority60 \lsdlocked0 Light Shading Accent 1;
\lsdpriority61 \lsdlocked0 Light List Accent 1;\lsdpriority62 \lsdlocked0 Light Grid Accent 1;\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 1;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 1;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 1;
\lsdsemihidden1 \lsdlocked0 Revision;\lsdqformat1 \lsdpriority34 \lsdlocked0 List Paragraph;\lsdqformat1 \lsdpriority29 \lsdlocked0 Quote;\lsdqformat1 \lsdpriority30 \lsdlocked0 Intense Quote;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 1;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 1;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 1;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 1;\lsdpriority70 \lsdlocked0 Dark List Accent 1;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 1;
\lsdpriority72 \lsdlocked0 Colorful List Accent 1;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 1;\lsdpriority60 \lsdlocked0 Light Shading Accent 2;\lsdpriority61 \lsdlocked0 Light List Accent 2;\lsdpriority62 \lsdlocked0 Light Grid Accent 2;
\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 2;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 2;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 2;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 2;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 2;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 2;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 2;\lsdpriority70 \lsdlocked0 Dark List Accent 2;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 2;
\lsdpriority72 \lsdlocked0 Colorful List Accent 2;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 2;\lsdpriority60 \lsdlocked0 Light Shading Accent 3;\lsdpriority61 \lsdlocked0 Light List Accent 3;\lsdpriority62 \lsdlocked0 Light Grid Accent 3;
\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 3;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 3;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 3;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 3;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 3;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 3;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 3;\lsdpriority70 \lsdlocked0 Dark List Accent 3;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 3;
\lsdpriority72 \lsdlocked0 Colorful List Accent 3;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 3;\lsdpriority60 \lsdlocked0 Light Shading Accent 4;\lsdpriority61 \lsdlocked0 Light List Accent 4;\lsdpriority62 \lsdlocked0 Light Grid Accent 4;
\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 4;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 4;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 4;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 4;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 4;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 4;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 4;\lsdpriority70 \lsdlocked0 Dark List Accent 4;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 4;
\lsdpriority72 \lsdlocked0 Colorful List Accent 4;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 4;\lsdpriority60 \lsdlocked0 Light Shading Accent 5;\lsdpriority61 \lsdlocked0 Light List Accent 5;\lsdpriority62 \lsdlocked0 Light Grid Accent 5;
\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 5;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 5;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 5;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 5;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 5;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 5;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 5;\lsdpriority70 \lsdlocked0 Dark List Accent 5;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 5;
\lsdpriority72 \lsdlocked0 Colorful List Accent 5;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 5;\lsdpriority60 \lsdlocked0 Light Shading Accent 6;\lsdpriority61 \lsdlocked0 Light List Accent 6;\lsdpriority62 \lsdlocked0 Light Grid Accent 6;
\lsdpriority63 \lsdlocked0 Medium Shading 1 Accent 6;\lsdpriority64 \lsdlocked0 Medium Shading 2 Accent 6;\lsdpriority65 \lsdlocked0 Medium List 1 Accent 6;\lsdpriority66 \lsdlocked0 Medium List 2 Accent 6;
\lsdpriority67 \lsdlocked0 Medium Grid 1 Accent 6;\lsdpriority68 \lsdlocked0 Medium Grid 2 Accent 6;\lsdpriority69 \lsdlocked0 Medium Grid 3 Accent 6;\lsdpriority70 \lsdlocked0 Dark List Accent 6;\lsdpriority71 \lsdlocked0 Colorful Shading Accent 6;
\lsdpriority72 \lsdlocked0 Colorful List Accent 6;\lsdpriority73 \lsdlocked0 Colorful Grid Accent 6;\lsdqformat1 \lsdpriority19 \lsdlocked0 Subtle Emphasis;\lsdqformat1 \lsdpriority21 \lsdlocked0 Intense Emphasis;
\lsdqformat1 \lsdpriority31 \lsdlocked0 Subtle Reference;\lsdqformat1 \lsdpriority32 \lsdlocked0 Intense Reference;\lsdqformat1 \lsdpriority33 \lsdlocked0 Book Title;\lsdsemihidden1 \lsdunhideused1 \lsdpriority37 \lsdlocked0 Bibliography;
\lsdsemihidden1 \lsdunhideused1 \lsdqformat1 \lsdpriority39 \lsdlocked0 TOC Heading;\lsdpriority41 \lsdlocked0 Plain Table 1;\lsdpriority42 \lsdlocked0 Plain Table 2;\lsdpriority43 \lsdlocked0 Plain Table 3;\lsdpriority44 \lsdlocked0 Plain Table 4;
\lsdpriority45 \lsdlocked0 Plain Table 5;\lsdpriority40 \lsdlocked0 Grid Table Light;\lsdpriority46 \lsdlocked0 Grid Table 1 Light;\lsdpriority47 \lsdlocked0 Grid Table 2;\lsdpriority48 \lsdlocked0 Grid Table 3;\lsdpriority49 \lsdlocked0 Grid Table 4;
\lsdpriority50 \lsdlocked0 Grid Table 5 Dark;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful;\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful;\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 1;\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 1;
\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 1;\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 1;\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 1;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 1;
\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 1;\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 2;\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 2;\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 2;
\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 2;\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 2;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 2;\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 2;
\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 3;\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 3;\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 3;\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 3;
\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 3;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 3;\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 3;\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 4;
\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 4;\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 4;\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 4;\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 4;
\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 4;\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 4;\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 5;\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 5;
\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 5;\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 5;\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 5;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 5;
\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 5;\lsdpriority46 \lsdlocked0 Grid Table 1 Light Accent 6;\lsdpriority47 \lsdlocked0 Grid Table 2 Accent 6;\lsdpriority48 \lsdlocked0 Grid Table 3 Accent 6;
\lsdpriority49 \lsdlocked0 Grid Table 4 Accent 6;\lsdpriority50 \lsdlocked0 Grid Table 5 Dark Accent 6;\lsdpriority51 \lsdlocked0 Grid Table 6 Colorful Accent 6;\lsdpriority52 \lsdlocked0 Grid Table 7 Colorful Accent 6;
\lsdpriority46 \lsdlocked0 List Table 1 Light;\lsdpriority47 \lsdlocked0 List Table 2;\lsdpriority48 \lsdlocked0 List Table 3;\lsdpriority49 \lsdlocked0 List Table 4;\lsdpriority50 \lsdlocked0 List Table 5 Dark;
\lsdpriority51 \lsdlocked0 List Table 6 Colorful;\lsdpriority52 \lsdlocked0 List Table 7 Colorful;\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 1;\lsdpriority47 \lsdlocked0 List Table 2 Accent 1;\lsdpriority48 \lsdlocked0 List Table 3 Accent 1;
\lsdpriority49 \lsdlocked0 List Table 4 Accent 1;\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 1;\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 1;\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 1;
\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 2;\lsdpriority47 \lsdlocked0 List Table 2 Accent 2;\lsdpriority48 \lsdlocked0 List Table 3 Accent 2;\lsdpriority49 \lsdlocked0 List Table 4 Accent 2;
\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 2;\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 2;\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 2;\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 3;
\lsdpriority47 \lsdlocked0 List Table 2 Accent 3;\lsdpriority48 \lsdlocked0 List Table 3 Accent 3;\lsdpriority49 \lsdlocked0 List Table 4 Accent 3;\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 3;
\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 3;\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 3;\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 4;\lsdpriority47 \lsdlocked0 List Table 2 Accent 4;
\lsdpriority48 \lsdlocked0 List Table 3 Accent 4;\lsdpriority49 \lsdlocked0 List Table 4 Accent 4;\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 4;\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 4;
\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 4;\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 5;\lsdpriority47 \lsdlocked0 List Table 2 Accent 5;\lsdpriority48 \lsdlocked0 List Table 3 Accent 5;
\lsdpriority49 \lsdlocked0 List Table 4 Accent 5;\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 5;\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 5;\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 5;
\lsdpriority46 \lsdlocked0 List Table 1 Light Accent 6;\lsdpriority47 \lsdlocked0 List Table 2 Accent 6;\lsdpriority48 \lsdlocked0 List Table 3 Accent 6;\lsdpriority49 \lsdlocked0 List Table 4 Accent 6;
\lsdpriority50 \lsdlocked0 List Table 5 Dark Accent 6;\lsdpriority51 \lsdlocked0 List Table 6 Colorful Accent 6;\lsdpriority52 \lsdlocked0 List Table 7 Colorful Accent 6;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Mention;
\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Smart Hyperlink;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Hashtag;\lsdsemihidden1 \lsdunhideused1 \lsdlocked0 Unresolved Mention;}}{\*\datastore 010500000200000018000000
4d73786d6c322e534158584d4c5265616465722e362e3000000000000000000000060000
d0cf11e0a1b11ae1000000000000000000000000000000003e000300feff090006000000000000000000000001000000010000000000000000100000feffffff00000000feffffff0000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffdfffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffff52006f006f007400200045006e00740072007900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016000500ffffffffffffffffffffffff0c6ad98892f1d411a65f0040963251e5000000000000000000000000e0a6
d4dbbf7fdc01feffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000105000000000000}}